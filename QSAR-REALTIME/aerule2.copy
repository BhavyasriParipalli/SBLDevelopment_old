 /********************************************************************/
 /*****  S T A R T   O F   C O P Y  --    A E R U L E 2           ****/
 /*****  THIS IS THE AUDIT EDIT RULE SOURCE.  IT IS DEPENDENT     ****/
 /*****  ON THE AEFEDIT MACRO, WHICH MUST BE INCLUDED IN THE      ****/
 /*****  SAME MODULE THAT THIS RULE IS INCLUDED IN.               ****/
 /********************************************************************/
 /*                                                                  */
 /*     ========================================================     */
 /*     ====************************************************====     */
 /*     ====*******   N  O  T  E  -  N  O  T  E      *******====     */
 /*     ====************************************************====     */
 /*     ========================================================     */
 /*                                                                  */
 /*   THE CROSS CHECK OF CNRULE2 AND AERULE2 HAS NOT BEEN DONE YET,  */
 /*   05/12/2005.  THIS NEEDS TO BE DONE IN ORDER TO DETERMINE IF    */
 /*   ANY MORE ERROR CODES NEED TO BE ADDED TO THE US ERROR CODE     */
 /*   TABLE, QAR, PRISM, IBMFIRST AND TO AERULE2.  NOTE AFTER PROLOG */
 /*   ALSO!                                                          */
 /*                                                                  */
 /*   THIS NOTE CAN BE REMOVED AFTER THIS CROSS CHECK HAS BEEN DONE. */               
 /*   don't forget to update the helpaudit document                  */               
 /********************************************************************/
 /*                                                                  */
 /*  MODULE:  AERULE2                                                */
 /*                                                                  */
 /*  PROGRAM LANGUAGE: PL/I                                          */
 /*  PROGRAM TYPE:     PROGRAM INCLUDE                               */
 /*                                                                  */
 /*  FUNCTION:   PERFORM AUDIT/EDIT of QSAR record                   */
 /*                                                                  */
 /*  INVOCATION: INVOKED FROM AEQRUL3                                */
 /*                                                                  */
 /*  UPDATE LOG:                                                     */
 /*  ----   ----------- ------------------------ --------    ------- */
 /*  8NSM    SR 9891    INITIAL VERSION            7/21/88   SPZ     */
 /*  8NSM    I74839     UPDATE MODS N/A AUDITS    02/15/89   SPZ     */
 /*  8NSM    I75601     SET PART_TRAILER SWITCH   03/01/89   SPZ     */
 /*  8NSM    I76127     FIX DEL POINT EDITS,      03/17/89   SPZ     */
 /*                     TAKE OUT 113 ERROR, FIX STOP                 */
 /*                     TIME FOR PART TRAILERS                       */
 /*          I76288     BLANK MILEAGE WITH ERROR 60                  */
 /*          I76300     DISALLOW OVERTIME WITH SC 65                 */
 /*          RICKARD    FORCE 011 OR 111 WITH 44 EVEN                */
 /*                     IF SERIAL NOT ENTERED                        */
 /*          RICKARD    FORCE 064 IF NOT SC 47, OTHER OFFICE         */
 /*                     NOT ON BOREF                                 */
 /*  8NSM    I76300     FIX SC 08 MACHINE SERIAL  03/17/89   SPZ     */
 /*                     AUDITS TO ALLOW MACH TYPE 9999               */
 /*  8NSM    I76367     BLANK SOME FIELDS WHICH   03/20/89   SPZ     */
 /*                     A WARNING  & CORRECT MSG 253                 */
 /*  8NSM    I76481     PEND RECORD WHEN NO STOP  03/22/89   LBS     */
 /*                     FOR SERVICE CODES OTHER THAN 65              */
 /*  8NSM    I76612     CHANGE ALPHANB CHECK ON BINLOC 03/24/89 LBS  */
 /*                     TO ALPHAN                                    */
 /*  8NSM    I75400     FORCE STOP TIME TO BE > 000 WHEN SC IS       */
 /*                     NOT 65                    03/27/89   SPZ     */
 /*  9NSA    I77769     DON'T REQUIRE ACTUAL HOURS IF SC=08 OR 33    */
 /*                                               05/01/89   SPZ     */
 /*  9NSA    I78455     DON'T AUDIT MTM IF THERE HAS NOT BEEN A      */
 /*                     MATCH TO INVENTORY        05/08/89   LBS     */
 /*  9NSA    I78913     IS SERVICE CODE = 47 THEN THE OTHER BRANCH   */
 /*                     OFFICE WORKED MUST BE MARKETING OFFICE OR    */
 /*                     ONE OF 12 SPECIFIC SERVICE OFFICES           */
 /*                                               05/16/89   LBS     */
 /*  9NSA    I80290     ALT SHIP BO/DEL PT CODING INCORRECT          */
 /*                     NEEDED A DO-END BLOCK                        */
 /*                                               06/14/89   LBS     */
 /*  9NSA    I80364     MINORITY CONTRACTOR SERIAL NUMS START WITH C */
 /*                                               06/19/89   LBS     */
 /*  0NSA    SR9892     BILLABLE ACTIVITY CODE AUDIT CHANGE      LBS */
 /*  0NSA   DCR9892H    ADD SC 33 TO BILLABLE ACTIVITY CODE      LBS */
 /*                     AUDIT/EDIT                                   */
 /*                                                                  */
 /*  0NSE    SR284      BYPASS PEND 011 ERROR IF SC IS 48 AND        */
 /*                     MACHINE TYPE IS VALID ROLM MACHINE TYPE      */
 /*                     AND MACHSER IS 0099999 OR 9999999            */
 /*                                                 02/27/90  ABM    */
 /*                                                                  */
 /*  0NSE    SR348      GIVE PEND 064 ERROR IF MACHINE TYPE IS VALID */
 /*                     ROLM MACHINE TYPE AND RSO IS NOT EQUAL TO CE */
 /*                     ASSIGNED BRANCH OFFICE AND "OTHER OFFICE"    */
 /*                     FIELD FROM QSAR IS BLANK                     */
 /*                                                 02/27/90  ABM    */
 /*                                                                  */
 /*  0NSK    SR595      ON HDA QSARS, CHECK TO SEE THAT PART NUMBER  */
 /*                     IS VALID FOR THE MACHINE TYPE SPECIFIED      */
 /*                     GIVE APPROPRIATE PEND MESSAGE WHEN THE PART  */
 /*                     NUMBER/MACHINE TYPE COMBINATION IS INVALID   */
 /*                                                                  */
 /*                                                 09/10/90  ABM    */
 /*                                                                  */
 /*  0NSK    SR483      CHECK THE CONTRACT NUMBER FOR SC 44.  IF IT  */
 /*                     DOESN'T FALL IN THE CORRECT RANGE THEN       */
 /*                     PEND THE QSAR WITH A PEND NUMBER OF 20.      */
 /*                                                                  */
 /*                                                 09/11/90  BLS    */
 /*                                                                  */
 /*  0NSK    I106733    CORRECT CONTRACT RANGE KEY VALUE.            */
 /*                                                 11/27/90  BLS    */
 /*                                                                  */
 /*  0NSL    I105677    CORRECT BRANCH OFFICE MISSING/INVALID ERROR. */
 /*                                                 01/04/91  DLP    */
 /*                                                                  */
 /*  0NSL    DCR483C    ADD BYPASS OF CONTRACT NUMBER AUDIT/EDITS    */
 /*                     FOR ADP "C1090" CONTRACT NUMBERS             */
 /*                                                 01/07/91  ABM    */
 /*  0NSL    SR 0746    ADD CHECK ON OTHER BRANCH OFFICE FOR NON-    */
 /*                     ROLM EMPLOYEES                 02/19/91 LBS  */
 /*  1NSC     I106581   ALLOW NULLS IN B/A WHEN        03/01/91 DLP  */
 /*                     CONTRACT IS PRESENT                          */
 /*  1NSG    SR 0768    ADD AUDIT/EDIT FOR PC BID CONTRACT           */
 /*                     QSAR MACHINE TYPE MATCH (M_PCBID FLAG)       */
 /*                                                 05/17/91  ABM    */
 /*  1NSM    SR 0853    ADD AUDIT/EDIT FOR COS CONTRACT NUMBER -     */
 /*                     EXACT MATCH INSTEAD OF RANGE CHECK.          */
 /*                                                 10/22/91  DLK    */
 /*  2NSA    SR 0848    PEND WITH ERROR 52 IF ACTHRS<PMHRS FLAG      */
 /*                     IS SET TO 'Y'               02/12/92  ABM    */
 /*  2NSD    SR 0972    NEW AUDITS FOR PRODUCT ID FIELD              */
 /*                                                 04/24/92  ABM    */
 /*  2NSD    SR 0973    ADD HDA PART NUMBERS 065F8001 AND 065F8002   */
 /*                     TO HDA AUDITS FOR MACHINE TYPE 3390          */
 /*                                                 04/24/92  ABM    */
 /*  2NSD    SR 0974    NEW HDA AUDITS FOR MACHINE TYPE 9345 WITH    */
 /*                     PART NUMBERS 066F1405 AND 066F1406           */
 /*                                                 04/24/92  ABM    */
 /*  2NSD    SR 0590    NO WARNING ERROR FOR METER ON S/C 44         */
 /*                                                 05/19/92  ABM    */
 /*  2NSD    SR 1061    NEW AUDITS FOR SERVICE PERFORMANCE FIELD     */
 /*                                                 05/20/92  ABM    */
 /*  2NSD    DCR1061C   REMOVE AUDITS FOR SERVICE PERFORMANCE        */
 /*                                                 06/17/92  ABM    */
 /*  2NSF    H0016664   USE PEND_HDA FLAG FOR HDA PART NUMBER        */
 /*                     AUDITS (FLAG SET IN AEQDBU1) 07/22/92 ABM    */
 /*  2NSJ    SR1121     USE MT_IS_PRODID FLAG TO PEND MACHINE        */
 /*                     TYPE IF PRODUCT ID VALUE IS ENTERED          */
 /*                     (BYPASS THIS AUDIT FOR ROLM AND PENNANT CE'S)*/
 /*                                                 10/06/92  ABM    */
 /*  2NSJ    H0035297   MAKE MACHINE SERIAL OPTIONAL FOR SC44        */
 /*                                                 10/06/92  ABM    */
 /*  2NSJ    SR1084     ALLOW B/A OF 7 ON S/C 01 QSARS               */
 /*                                                 10/06/92  ABM    */
 /*  3NSB    SR1122     ALLOW ACTIVITY CODE OF EITHER 41 OR NULL     */
 /*                     WHEN SERVICE CODE IS 44     11/23/92  ABM    */
 /*  3NSB    SR1124     ALLOW B/A OF 4 WHEN SERVICE CODE IS 08       */
 /*                                                 11/23/92  ABM    */
 /*  3NSD    I166534    CHANGE WORK_NUM DECLARE TO FIXED DEC(7,1)    */
 /*                     SO THAT TENTHS OF HOURS WILL BE CONSIDERED   */
 /*                     IN THE GENERAL HOURS AUDITS                  */
 /*                                                  1/29/93  ABM    */
 /*  3NSD    SR93045    ADD ENHANCED PCBID CONTRACT NUMBER AUDITS    */
 /*                                                  2/19/93  DLK    */
 /*                                                                  */
 /*  3NSF    I175941    ERASE BA7 QSARS WITHOUT A BILLABLE FC        */
 /*                     (02 OR 21)                  04/05/93  DLK    */
 /*  3NSJ   S9300144    ADD CHECK FOR SOURCED FROM KODAK ON   LBS    */
 /*                     PT ASSIGNED BRANCH OFFICE                    */
 /*  3NSL    SR93017    ADD MANDATORY MACHINE SERIAL FOR      DLK    */
 /*                     ROLM MACHINES, SERVICE CODE 44               */
 /*                     PT ASSIGNED BRANCH OFFICE                    */
 /*  3NSN    S9300198   CHANGE AUDITS TO ALLOW FOR NEW SOFTWARE      */
 /* 11/04/93            SERVICE CODE 94.                             */
 /*          DCR198-1   EXPAND SC94 ACTIVITY CODES TO INCLUDE ALL    */
 /*                     NUMERICS.                             DLK    */
 /*  3NSP    S94000XX   CHANGE AUDITS ON OTHER BRANCH OFFICE TO      */
 /*                     MAKE SURE ON KODAK RECORDS THE OTHER BRANCH  */
 /*                     IS A SERVICE OFFICE                     LBS  */
 /*  4NSA    S9400031   ADD AUDITS FOR PRODUCT ID ON SC 94      LBS  */
 /*  4NSC    S9300252   PM FREQ FOR ALL SC 08                        */
 /*          S9300006   INCREASE NON-OT HOURS TO 12             DLK  */
 /*  4NSC    I0251172   DON'T DO OVT EDITS IF EMPL NOT ON EDF   DLK  */
 /*  4NSC    S9400092   MANDATORY PROBLEM NO FOR SC94, AC *1    DLK  */
 /*                                                                  */
 /*  4NSG    S9400091   MOVE BILLABLE CODE AUDITS TO HOST       DLK  */
 /*  4NSG    I0270413   07/28/94   TEST INFO - ADD MODS = 2 ECA NO.  */
 /*                                TEST TO BILLABLE CODE AUDITS. DLK */
 /*  4NSG    I0268799   07/29/94   TEST INFO - ALLOW PROB NUMBER TO  */
 /*                                REMAIN FOR ALL SC 94.         DLK */
 /*  4NSM    S9300229   10/10/94   REMOVE 'STATIC' ATTRIBUTE FROM    */
 /*                                VARS. PEND INVALID EXPENSES.  DLK */
 /*  4NSM    S9400170   01/20/95   ADD CONTRACT PEND MESSAGE 20 FOR  */
 /*                                EB CONTRACT ERRORS. PROMPT BA     */
 /*                                EVEN IF CONTRACT IS ENTERED.  DLK */
 /*  4NSM    H0167211   02/15/95   FIX BA AUDITS WHEN CSS IS ENTERED */
 /*                                                              DLK */
 /*  5NSA    S9500014   02/20/95   OPTIONAL STOP TIME/99.9 ACTUAL    */
 /*                                HOURS/SKIP OT BALANCE ON SC 94    */
 /*                                                              DLK */
 /*  5NSA S9500023 03/07/95 ADD CHECK FOR SC 94 AND ACTUAL + TRVL    */
 /*                         HRS > 99.9                           LBS */
 /*  5NSC S9500015 03/16/95 ADD CHECK FOR SC 94 ACTIVITY CODE *4     */
 /*                         THAT BILL_TYPE (SOCTAC) >= $60       LBS */
 /*                         ADD CHECK FOR CUSTOMER NUMBER        LBS */
 /*  5NSC C9502803 04/11/95 ADD CHECK FOR SC 48 M/T 9999 &       LBS */
 /*                         M/S OF 5 9'S                             */
 /*  5NSC C9502804 04/13/95 NO SC CUST OR ACTV FOR ROLM          DLK */
 /*  5NSC H0177117 04/13/95 CORRECT SC 48 ACTIVITY CODE AUDIT    DLK */
 /*  5NSC I0343411 04/14/95 CORRECT STOP TIME AUDIT FROM 5NSA    LBS */
 /*                         PART TLR STOP NOT REQ TO BE BLANK        */
 /*  5NSC I0346116 04/25/95 MAKE 5NSC AUDITS TABLE LEVEL INDEPENDENT */
 /*  5NSC I0346449 04/26/95 DISALLOW OT>ACT+TRV FOR ALL QSARS    DLK */
 /*  5NSD S9500109 05/10/95 ALLOW ACTIVITY CODE 12 ON SC 01      LBS */
 /*       S9400074 05/10/95 REMOVE A/U TIME PROMPT.              DLK */
 /*  5NSE S9500073 05/27/95 SENSITIVE PARTS ASSET TRACKING       LBS */
 /*                         TIN NUMBER CHECKING                      */
 /*  5NSE S9500206 06/22/95 EXPAND P/N, M/S, EXPENSE, ETC.       DLK */
 /*  5NSE I0365125 07/07/95 PEND QSAR WHEN SC 48 AND CN=0        LBS */
 /*  5NSE S9500129 07/21/95 IMPROVE SC 94 CONTRACT AUDITS        DLK */
 /*  5NSE H0194382 07/31/95 ADDITIONAL AUDITS ON BILL TYPE       DLK */
 /*  5NSE I0377958 08/11/95 FIX PEND STATUS ON ERASED ORDER QTY  DLK */
 /*  5NSF S9500175 09/09/95 BYPASS MACHINE SERIAL CHECK WHEN     LBS */
 /*                         BETHESDA CONTROLLED AND CONT=INNNNNN     */
 /*  5NSF I0390883 09/21/95 CORRRECT MACH SERIAL SC 8 BYPASS     LBS */
 /*                         'XXXXX' TO '00XXXXXX'                    */
 /*  5NSM S9500187 10/19/95 IGNORE INVENTORY MATCH REQUIRED ON   LBS */
 /*                         QSARS SOURCED FROM DART                  */
 /*  5NSM S9500178 10/26/95 ADD ACTIVITY CODES TO SC 01 & 36     LBS */
 /*       S9500181                                                   */
 /*  5NSM I0407445 11/09/95 DON'T ERASE PROBLEM NUMBER ON QSARS  LBS */
 /*                         SOURCED FROM DART                        */
 /*  6NSC S9570002 02/13/96 CHECK FOR OVERTIME IF ACT+TRVL > 12  LBS */
 /*                         IS ELIMINATED                            */
 /*  6NSE S9500060 04/09/96 CUSTOMER NAME IS REQUIRED FOR TRUER  LBS */
 /*                         ENTRY                                    */
 /*  6NSF S9600167 05/09/96 REMOVE THE BETHESDA CONTROLLED FLAG  LBS */
 /*                         CHECK ON MACHINE SERIAL BYPASS.  IF      */
 /*                         CONTRACT = Innnnnn, INV MATCH NOT REQD   */
 /*  6NSG S9570033 05/20/96 ASSET TRACKING / ADD PRF PROMPT          */
 /*                         TO PT TABLE                              */
 /*       S9600166          MAKE OTHER BRANCH OFFICE                 */
 /*                         MANDATORY ON SC 47                       */
 /*       S9600201          PROMPT FOR MFG/MOD WHEN AC = 14          */
 /*       S9600225          PROMPT FOR QUANTITY WHEN FC IS 06.       */
 /*       C9622501          CHANGE BIN LOCATION TO BIN/ORDER#        */
 /*                         AND MAKE IT OPTIONAL                     */
 /*       S9600235          ADD NEW PLAN/INST/RR/DIS CODE TO SC 20   */
 /*       S9600243          REMOVE ROLM PRODUCTS FROM TAC            */
 /*                         REPORTING. ALSO REMOVE SAUSE REPAIR      */
 /*                         AND THE SEVERITY PROMPTS.                */
 /*  6NSG B0069810 07/26/96 CORRECT CONDITION ON SC 55/65 ACT HRS LBS*/
 /*  6NSI C9506001 08/08/96 STOP TIME OPTIONAL WHEN DATA ENTERED  LBS*/
 /*                         VIA TRUER AND PROFILE = I/T              */
 /*  6NSJ S9600490 08/02/96 REMOVE PCBID FEED FROM QSAR          MKP */
 /*       S9600099 08/07/96 ASSET TRACKING FOR PET/TRUER         MKP */
 /*       S9600141 08/07/96 ADD CONTRACT AUDITS FOR CTOOL        DLP */
 /*       S9500141 08/07/96 ADD CONTRACT AUDITS FOR ENHANCED     DLP */
 /*       I0500331 08/07/96 CHANGE THE WAY WE LOOK AT THE        DLP */
 /*                         INNNNNN AND ISSC FIELDS                  */
 /*       I0500331 08/07/96 CHANGE THE WAY WE LOOK 011 ERROR     DLP */
 /*                         AS IT RELATES TO CONTRACTS.              */
 /*  6NSP S9600500 10/02/96 REQUIRE TIN ON APC 1                 MKP */
 /*       S9600489 10/02/96 FOR OWNER CODE AU AND CE OL MUST BE  MKP */
 /*                         >= 500 (EXPENSE LOCATION)                */
 /*  6NSR I521795  12/11/96 CORRECT LENGTH CHECKS FOR MSERIAL    DLP */
 /*  7NSA PRODSUPT 01/02/97 ADD FPETDLPT FIELD FOR TRUER FOR     DLP */
 /*                         DOWN LEVEL PET TABLE INDICATOR           */
 /*       S9600638 10/15/96 VALIDATE S/N LENGTH ON SELECT            */
 /*                         OEM M/TS.                            DLP */
 /*  7NSG S97049   04/08/97 ADD CEDB CONTRACT VALIDATION CHECKS  DLP */
 /*  7NSG S97033   04/08/97 ADD DROP O/L VALIDATION              DLP */
 /*  7NSG S97075   04/15/97 ADD ADP/DART CONTRACT AUDIT CHECK    LBS */
 /*       S97076                                                     */
 /*  7NSI S9600755 05/06/97 SUPPORT NSS MRO PARALLEL SYSPLEX     LBS */
 /*                         PROJECT AND YEAR 2000 CHANGES            */
 /*  7NSI           7/9/97  ACCORDING TO KATHY GIOGLIO, DART     LBS */
 /*                         RECORDS SHOULD PERFORM TO THE SAME       */
 /*                         AS PREVIOUSLY BEFORE CONTRACT/NO MPI     */
 /*                         CHECKING WAS INSTITUTED                  */
 /*  7NSI B0191629  7/29/97 ALLOW GREATER THAN 24 HRS FOT IT     MKP */
 /*  7NSP S97133    7/29/97 PROBLEM NUMBER UPDATE                LBS */
 /*                         FUNCTION CODE 4/99                   DLP */
 /*  7NSP S97201   10/22/97 CHANGE PEND TO WARNING ON CODE 22    LBS */
 /*                         DOWNLEVEL TABLE CHECK                    */
 /*  7NSP IXXXXX   12/05/97 CHANGE S0ISENOL >= '500              MKP */
 /*                         FROM S0ISENOL < '500')                   */
 /*  8NSE S97219   03/30/98 ADD CODE FOR FUNCTION CODE 09/10     MKP */
 /*  8NSB PER JEFF 04/17/98 TEMPORARILY MAKE 338 A WARNING       LBS */
 /*  8NSG S97085   04/24/98 AUDIT THE ZIP CODE                   DLP */
 /*  8NSI S98077   05/11/98 AUDIT THE BILL CODE                  DLP */
 /*  8NSI B0266601 07/15/98 IF PO AND ZIP INVALID WARN AND       MKP */
 /*                         BLANK OUT THE ZIP CODE                   */
 /*  8NSM S98112   08/10/98 ADD CONDITIONAL CHECKS ON PART       LBS */
 /*                         DO AUDIT IF TSS OWNED PART.              */
 /*  8NSN S98153   10/27/98 ADD ACTIVITY CODE 80 FOR SC 44       MKP */
 /*  8NSN S98225   11/09/98 REMOVE ACTIVITY CODE '14' ON SC 01   LBS */
 /*  8NSN S98153   11/10/98 PEND FOR VALID TSS ALLIANCE CONTRACT     */
 /*                         THAT DOES NOT HAVE ACTIVITY CODE 10  DLP */
 /*  8NSN S98123   11/10/98 ALLOW FC 01 ON IR RECORDS            DLP */
 /*  8NSN S98153   11/11/98 PEND FOR TSS EMPLOYY ON ACT 99       DLP */
 /*  8NSN I0996149 12/07/98 PLACE CHECK FOR TSS EMPLOYEE IN      LBS */
 /*                         CORRECT PLACE                            */
 /*  8NSN S98005   01/16/99 DONOT RETURN DERIVED CNTR PEND MSG   SFM */
 /*  8NSN I1184600 05/05/99 CHANGE CHECK FOR SC 94 AC 11 FROM    DLP */
 /*                         7 TO 5.                                  */
 /*  0NSB T5475729 01/16/2000 fix prodid problem (ALPHNUM)       MKP */
 /*  0NSD S00048   04/27/2000 add warning for missing waybill    LBS */
 /*  0NSF S00056   06/02/2000 allow a/n del pt                   MKP */
 /*  0NSF S00061   06/19/2000 pend if process level code = 0     LBS */
 /*                           and blank or invalid contract (038)    */
 /*                           remove cgctcp = rolm check on prodid   */
 /*  0NSF S00057   07/31/2000 Order QTY not allowed when FROMOL  LBS */
 /*                           is > 496 and FUNCTION CODE = '01'      */
 /*  0NSH PRODSUPT 10/30/2000 remove ftype_check on contract checking*/
 /*                           not set in CPCNTR                      */
 /*  0NSK PRODSUPT 01/22/2001 add error 19 future date           LBS */
 /*                           remove references to FSRCKDK           */
 /*  1NSG PRODSUPT 04/26/2001 remove pet table level references  MKP */
 /*  1NSP S01032   07/25/2001 add SC 44 Work Number Activity chks LBS*/
 /*       PRODSUPT            remove DROP_OL checks (172,197,229,247)*/
 /* 1NSP Mn6626829 09/18/2001 cinvcntr = X and SC 01 not audited  LBS*/
 /* 2NSG SR02xxxx  05/15/2002 do not pend for no match to inv on  LBS*/
 /*                           SC 20 & 44                             */
 /* 2NSK SR02xxxx  07/19/2002 do pend when SC 33 and modna = '2'  LBS*/
 /*                           not applied                            */
 /* 2NSM SR020011  08/14/2002 add addition activity  performed    dlp*/
 /*                           codes to service Activity 44           */
 /* 2NSM Prodsup   08/16/2002 add FC 02 and 21 check for          DLP*/
 /*                           receiving OL to be in the range of     */
 /*                           500 to 999 on part lines 1 through 4   */
 /* 2NSM Prodsup   08/26/2002 Remove Ba code 7 and 9              DLP*/
 /* 2NSM Prodsup   08/26/2002 remove function code 97             DLP*/
 /* 2NSM Prodsup   08/26/2002 tighten values for activity         DLP*/
 /*                           preformed  sc 48 and 94                */
 /* 2NSM Prodsup   09/03/2002 tighten values for S0ISENOL         DLP*/
 /*                           for FC 03 and 21(S0ISENOL < 496)       */
 /* 2NSM Prodsup   09/04/2002 remove error code 256 (S0ISENOL)    DLP*/
 /*                           for FC 03 - From O/L Must be >= 500    */
 /* 2NSM PRODSUPT  09/09/2002 Remove (COWNER = 'AU' | COWNER = 'CE') */
 /*                           processing errors 256(S0ISENOL)     DLP*/
 /*                           171, 195, 227, 245(S0IRECOL)           */
 /* 2NSM SR020035 09/09/2002  do not pend QSAR for not on invent  LBS*/
 /*                           for SC 20 and 44                       */
 /* 2NSM SR020046 09/13/2002  do not pend for machine not on      LBS*/
 /*                           inventory for SC 33 MODNA 2            */
 /* 3NSI SR030023 04/03/2003  Add warning check on QJBILMTR       LBS*/
 /* 3NSI NSS3NSI  04/17/2003  Add FPARTVAL on part data checking  LBS*/
 /*                           FROM BO, FROM OL, SEND BO, SEND OL     */
 /* 3NSK SR030014 06/17/2003  SC 20 changes                       LBS*/
 /* 4NSC PRODSUPT 09/30/2003  remove stop time check on part only LBS*/
 /* 4NSC PRODSUPT 01/27/2004  changed HAFMTREQ to M_MPIREQ        LBS*/
 /* 4NSC SR030019 03/05/2004  Add error 342 for invalid model on  LBS*/
 /*                           on contract rep contract               */
 /* 4NSC SR030069 03/17/2004  Add bypass MPI match reqd if the    DLP*/
 /*                           machine type/serial is not on MPI,     */
 /*                           but a match was required by MTM and    */
 /*                           it is a valid CEDB HV contract         */
 /* 4NSC SR040015 04/26/2004  remove machine type 2705 & 2785     LBS*/
 /*                           from copy count                        */
 /* 4NSG SR030069 03/17/2004  Add bypass MPI match reqd if the    DLP*/
 /*                           machine type/serial is not on MPI,     */
 /*                           but the FOEE (OEM Entitlement engine)  */
 /*                           it on                               DLP*/
 /* 4NSG prodsupt 09/23/2004  fix check on machine serial length  LBS*/
 /* 4NSG prodsupt 10/14/2004  add qty check on tin quantities     LBS*/
 /*                           NSS/CAD could enter > qty 1            */
 /* 5NSM SR040017 02/18/2005  add check for requesting employee   LBS*/
 /*                           being invalid (329 error)              */
 /*                           add act performed 11 to SA 55          */
 /* 5NSM SR040017 09/26/2005  ADD SC48 machine type check            */
 /* 5NSM SR040017 10/19/2005  add FSEROVRD check to machserbypass LBS*/
 /*                           remove FSRCDART logic                  */
 /* 6NSC SR050063 12/09/2005  SC 47 machine type optional for     LBS*/
 /*                           Canada                                 */
 /* QSAR6NSC004   01/27/2005  correct red tag usage audit         LBS*/
 /* 6NSH SR060019 04/19/2006  remove audit for part acq time      LBS*/
 /* 6NSJ SR060036 08/15/2006  add diagnostic message              LBS*/
 /* 7NSB prodsupt 01/15/2007 add ISOURCE check to PT BO check     LBS*/
 /* 7NSB prodsupt 03/05/2007 add AC 16, 17 to SC 44 check         LBS*/
 /* 7NSP SR060042 06/20/2007 add errors 355, 356                  LBS*/
 /* 7NSR prodsupt 10/23/2007 remove SC 44 on 077 CPN check        LBS*/
 /* 8NSM SR080003 04/25/2008 add Requesting Empl vs SSR SN check  LBS*/
 /* 8NSM Mn36971619 09/22/2008 revise check on Cust Name and SC20 LBS*/
 /* 9NSG mn       07/10/2009 add M/T 2709 to JBIL check           LBS*/
 /* 9NSM SR090005 08/13/2009 add audits for SC 94                 LBS*/
 /* 0NSE SR090008 12/30/2009 add M/T 4372 to JBIL check           LBS*/
 /* 0NSE prodsupt 12/30/2009 remove AC 24,30-39 from SA 36        LBS*/
 /* 0NSE SR100004 10/20/2010 add FPARTVAL on warning 254          LBS*/
 /*                                                                  */
 /********************************************************************/
 DCL UPDATED            CHAR(17) STATIC INIT('0NSE - 10/20/2010');

 GET_AUDIT_VER: PROC;

 /* THIS PROC CALLED BY AEQRUL3 */
 R_VER = '0NSE';                    /* PLEASE KEEP THIS UPDATED!!!! */

 END GET_AUDIT_VER;

 AUDIT_EDIT_RULE: PROC REORDER;

 DCL CPRTORGN_1        CHAR(1)    BASED(ADDR(CPRTORGN(1)));
 DCL CPRTORGN_2        CHAR(1)    BASED(ADDR(CPRTORGN(2)));
 DCL CPRTORGN_3        CHAR(1)    BASED(ADDR(CPRTORGN(3)));
 DCL CPRTORGN_4        CHAR(1)    BASED(ADDR(CPRTORGN(4)));
 DCL FOLINVAL_1        CHAR(1)    BASED(ADDR(FOLINVLD(1)));
 DCL FOLINVAL_2        CHAR(1)    BASED(ADDR(FOLINVLD(2)));
 DCL FOLINVAL_3        CHAR(1)    BASED(ADDR(FOLINVLD(3)));
 DCL FOLINVAL_4        CHAR(1)    BASED(ADDR(FOLINVLD(4)));
 DCL I           FIXED BIN(15);
 DCL IBMPART_1         CHAR(8)    BASED(ADDR(S0IPART(1)));
 DCL IBMPART_2         CHAR(8)    BASED(ADDR(S0IPART(2)));
 DCL IBMPART_3         CHAR(8)    BASED(ADDR(S0IPART(3)));
 DCL IBMPART_4         CHAR(8)    BASED(ADDR(S0IPART(4)));
 DCL IO_BUFFER         CHAR(89)   INIT('');

 DCL NON_OT_HRS        FIXED DEC(7,1) INIT(0);

 DCL OEMPART_1         CHAR(8)    BASED(ADDR(IOEMPART(1)));
 DCL OEMPART_2         CHAR(8)    BASED(ADDR(IOEMPART(2)));
 DCL OEMPART_3         CHAR(8)    BASED(ADDR(IOEMPART(3)));
 DCL OEMPART_4         CHAR(8)    BASED(ADDR(IOEMPART(4)));
 DCL OEMFLAG_1         CHAR(1)    BASED(ADDR(FOEMFLAG(1)));
 DCL OEMFLAG_2         CHAR(1)    BASED(ADDR(FOEMFLAG(2)));
 DCL OEMFLAG_3         CHAR(1)    BASED(ADDR(FOEMFLAG(3)));
 DCL OEMFLAG_4         CHAR(1)    BASED(ADDR(FOEMFLAG(4)));
 DCL PROB_CHAR7        CHAR(7)    BASED(ADDR(S0CCSCPC));
 
 DCL S0CFUNC_1         CHAR(2)    BASED(ADDR(S0CFUNC(1)));
 DCL S0CFUNC_2         CHAR(2)    BASED(ADDR(S0CFUNC(2)));
 DCL S0CFUNC_3         CHAR(2)    BASED(ADDR(S0CFUNC(3)));
 DCL S0CFUNC_4         CHAR(2)    BASED(ADDR(S0CFUNC(4)));
 DCL S0IBINLC_1        CHAR(6)    BASED(ADDR(S0IBINLC(1)));
 DCL S0IBINLC_2        CHAR(6)    BASED(ADDR(S0IBINLC(2)));
 DCL S0IBINLC_3        CHAR(6)    BASED(ADDR(S0IBINLC(3)));
 DCL S0IBINLC_4        CHAR(6)    BASED(ADDR(S0IBINLC(4)));
 DCL S0IMATL2_2        CHAR(4)    BASED(ADDR(S0IMATL2(2)));
 DCL S0IMATL2_3        CHAR(4)    BASED(ADDR(S0IMATL2(3)));
 DCL S0IMATL2_4        CHAR(4)    BASED(ADDR(S0IMATL2(4)));
 DCL S0IRECBO_1        CHAR(3)    BASED(ADDR(S0IRECBO(1)));
 DCL S0IRECBO_2        CHAR(3)    BASED(ADDR(S0IRECBO(2)));
 DCL S0IRECBO_3        CHAR(3)    BASED(ADDR(S0IRECBO(3)));
 DCL S0IRECBO_4        CHAR(3)    BASED(ADDR(S0IRECBO(4)));
 DCL S0IRECOL_1        CHAR(3)    BASED(ADDR(S0IRECOL(1)));
 DCL S0IRECOL_2        CHAR(3)    BASED(ADDR(S0IRECOL(2)));
 DCL S0IRECOL_3        CHAR(3)    BASED(ADDR(S0IRECOL(3)));
 DCL S0IRECOL_4        CHAR(3)    BASED(ADDR(S0IRECOL(4)));

 DCL S0QTRAHR_NUM      PIC '99V9' BASED(ADDR(S0QTRAHR));
 DCL S0QSVCHR_NUM      PIC '99V9' BASED(ADDR(S0QSVCHR));
 DCL S0QOVTHR_NUM      PIC '99V9' BASED(ADDR(S0QOVTHR));

 DCL S0QTRAHR_TEMP     PIC '99V9' INIT(0);
 DCL S0QSVCHR_TEMP     PIC '99V9' INIT(0);
 DCL S0QOVTHR_TEMP     PIC '99V9' INIT(0);

 DCL S0QDISUS_1        CHAR(2)    BASED(ADDR(S0QDISUS(1)));
 DCL S0QDISUS_2        CHAR(2)    BASED(ADDR(S0QDISUS(2)));
 DCL S0QDISUS_3        CHAR(2)    BASED(ADDR(S0QDISUS(3)));
 DCL S0QDISUS_4        CHAR(2)    BASED(ADDR(S0QDISUS(4)));
 DCL S0QREPOR_1        CHAR(2)    BASED(ADDR(S0QREPOR(1)));
 DCL S0QREPOR_2        CHAR(2)    BASED(ADDR(S0QREPOR(2)));
 DCL S0QREPOR_3        CHAR(2)    BASED(ADDR(S0QREPOR(3)));
 DCL S0QREPOR_4        CHAR(2)    BASED(ADDR(S0QREPOR(4)));
 DCL TEMP_SERIAL       CHAR(7)    INIT('');



 DCL ERR_SW              BIT(1)   INIT('0'B);
 DCL FC_FOUND            BIT(1)   INIT('0'B);
 DCL ON                  BIT(1)   INIT('1'B);
 DCL OFF                 BIT(1)   INIT('0'B);
 DCL MACHSER_BYPASS      BIT(1)   INIT('0'B);
 DCL MACHTYPE_BYPASS     BIT(1)   INIT('0'B);
 DCL PART_TRAILER        BIT(1)   INIT('0'B);
 DCL PART_ONLY           BIT(1)   INIT('0'B);


 /********************************************************************/
 /*                                                                  */
 /*  SET SOME FIELDS FOR LATER  USE.                                 */
 /********************************************************************/
 /********************************************************************/
 /* FIRST, SET PART TRAILER AND PART ONLY SWITCHES                   */
 /* NOTE - CHCDATIT IS SET IN AEQFMT1                                */
 /********************************************************************/

 IF S0IPARTR = '1'                           /* PART TRAILER         */
   THEN PART_TRAILER = ON;
   ELSE PART_TRAILER = OFF;

 IF CHCDATIT = 'P'  |                /* TYPE OF DATA ON QSAR         */
    CS1CFUNC = 'PO'                  /* FUNCTION USED TO CREATE QSAR */
   THEN PART_ONLY = ON;
   ELSE PART_ONLY = OFF;

 IF S0IMACSE > ' ' & INDEX(S0IMACSE,' ') < 9   /* MACHINE SERIAL     */
   THEN DO;
     TEMP_SERIAL = SUBSTR(S0IMACSE,1,7);
     CALL JUSTIFYRZ(TEMP_SERIAL);
   END;
   ELSE;

1/* START OF FIELD EDITS AND AUDITS */
 SYSTEM_FAIL:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  LINKFAIL_MPI LINKFAIL_CNTR  (015)                               */
 /*  --------------                                                  */
 /*  --------  IF SYSTEM PROBLEM, GIVE QSAR ERROR #15                */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /********************************************************************/
 IF LINKFAIL_MPI = 'Y' | LINKFAIL_CNTR = 'Y'
   THEN DO;
      ERR_SW = ON;
      FEDIT (ERR_SW,
             NOTALLOWED,
             BI,
             EQ,
             (ON),
             PEND,015)    /* A LINK TO THE MPI REGION FAILED */
      ERR_SW = OFF;
    END;

 END SYSTEM_FAIL;

 %PAGE;
 ACTIVITY_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  ACTIVITY CODE (44)                                              */
 /*  (S0CHACT) Numeric, right justified,                             */
 /*  -----------------------                                         */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /********************************************************************/

 IF S0CSVC = '08' | S0CSVC = '20' |                  /* SERVICE CODE */
    S0CSVC = '33' | S0CSVC = '47' |
    PART_TRAILER  | PART_ONLY
  THEN
    FEDIT (S0CHACT,
           REQUIRED,
           NUMB,
           EQ,
           ('  '),
           PEND,044)
  ELSE
   SELECT (S0CSVC);                                 /* SERVICE CODE */

     WHEN ('01')
       DO;
           FEDIT (S0CHACT,
                        REQUIRED,
                        NUMB,
                        EQ,
                        ('  ','10','11','12','13'),
                        PEND,044)
       END;
     WHEN ('36') FEDIT (S0CHACT,
                        REQUIRED,
                        NUM,
                        EQ,
                        ('20','22','25',
                         '62','67','68'),
                        PEND,044)

     WHEN ('44')
       DO;
         SELECT (S0CHACT);
           WHEN('10','12','13','14','15','16','17');
           WHEN('30','31','32','33','34','35','36','37','38','39');
           WHEN('40','41','42','43','44','45','46','47','48','49');
           WHEN('50','51','53','57');
           WHEN('61');
           WHEN('99')
             DO;
               /* -------------------------------------------- */
               /* CHECK TO SEE OF THE CE SERVICE GROUP IS TSS, */
               /* if so THEN THE ACTIVITY CODE IS NOT ALLOWED  */
               /* TO BE 99                                     */
               /* -------------------------------------------- */
               IF SUBSTR(ISRVGCE,1,3) =  'TSS'
                 THEN FEDIT (S0CHACT,
                             REQUIRED,
                             NUMB,
                             NE,
                             ('99'),
                             PEND,029)
              END;
           OTHERWISE
                 FEDIT (S0CHACT,
                      REQUIRED,
                      NUMB,
                      EQ,
                      ('  '),
                      PEND,044)
         END;                        /* END SELECT              */
       END;                               /* END OF WHEN ('44')      */

     WHEN ('48')
                                         /* INPUT DEVICE DOES DETAIL */
                                         /* CHECK OF DATA            */
             SELECT (S0CHACT);
               WHEN('11','12','13','14','15');
               WHEN('21','22','23','24','25');
               WHEN('31','32','33','34','35','36');
               WHEN('41','42','43','44','45','46');
               WHEN('51','52','53','54','55');
               WHEN('80','81','82','83','84');
               WHEN('90','91','92','93','94');

               OTHERWISE
                  DO;
                   ERR_SW = ON;
                   FEDIT (ERR_SW,
                   NOTALLOWED,
                   BI,
                   EQ,
                   (ON),
                   PEND,044)
                  END;
              END;                        /* END SELECT              */

     WHEN ('55') 
       DO;
         IF CWA.CWAARNUM = '19'
           THEN FEDIT (S0CHACT,
                       REQUIRED,
                       NUM,
                       EQ,
                       ('05'-'11'),
                       PEND,044)

           ELSE FEDIT (S0CHACT,
                       REQUIRED,
                       NUM,
                       EQ,
                       ('05'-'10'),
                       PEND,044)
       END;
     WHEN ('65') FEDIT (S0CHACT,
                        REQUIRED,
                        NUM,
                        EQ,
                        ('01'-'04'),
                        PEND,044)
                                         /* INPUT DEVICE DOES DETAIL */
                                         /* CHECK OF DATA            */
 
     OTHERWISE;
   END; /* SELECT */
   
 END ACTIVITY_CODE;

 %PAGE;
 ACTIVITY_DATE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  ACTIVITY DATE (018, 019)                                        */
 /*  (S0DCALCM, S0DCALCD, S0DCALCY)- Numeric                         */
 /*  --------------------------------------------                    */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /********************************************************************/
                        /* S0DCALCD  = CALL COMPLETE DAY   DD        */
  IF S0CSVC ^= '55' & S0CSVC ^= '65' &
    (S0DCALCY > CS1BSRYY)                      /* base services      */
    THEN DO;                                   /* receive year       */
      ERR_SW = ON;
      FEDIT (ERR_SW,
             NOTALLOWED,
             BI,
             EQ,
             (ON),
             PEND,019)
    END;

  IF ERR_SW
    THEN ;                       /* don't need to send 19 & 18 msg   */
    ELSE DO;
      FEDIT (S0DCALCD,
             NOTALLOWED,
             NUM,
             EQ,
            ('99'),
             PEND,018)
    END;

  ERR_SW = OFF;
                                         /* ---TEMP COMMENTED OUT--- */
                                         /* FEDIT (FPREACT,   6/29/98*/
                                         /*        REQUIRED,   PER   */
                                         /*        ALPHAN,    EDWARDS*/
                                         /*        NE,           LBS */
                                         /*        ('Y'),            */
                                         /*        WARNING,338)      */
                                         /* ------------------------ */
    FEDIT (FPREACT,
           REQUIRED,
           ALPHAN,
           NE,
           ('Y'),
           PEND,338)
                                         /* -----TEMP COMMETED OUT-- */
                                         /*                          */
                                         /* FEDIT (FPASTDEACT,       */
                                         /*        REQUIRED,  6/29/98*/
                                         /*        ALPHAN,     PER   */
                                         /*        NE,       EDWARDS */
                                         /*        ('Y'),        LBS */
                                         /*        WARNING,339)      */
                                         /*                          */
                                         /* ------------------------ */
    FEDIT (FPASTDEACT,
           REQUIRED,
           ALPHAN,
           NE,
           ('Y'),
           PEND,339)

 END ACTIVITY_DATE;

 %PAGE;
 ACTUAL_HOURS:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  ACTUAL HOURS (051, 052, 311)                                    */
 /*  (S0QSVCHR) (Numeric)                                            */
 /*  -----------------------                                         */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

  /* PEND WITH ERROR 52 IF ACTHRS < PMHRS FLAG IS SET TO 'Y' */
  IF PEND_PM = 'Y'
    THEN CALL SET_ERROR_ARRAY(196,'S0QSVCHR',3,52);

  FEDIT (FHRSINV,
         REQUIRED,
         ALPHAN,
         NE,
         ('Y'),
         PEND,337)

 /* IF A PART TRAILER, ACTUAL HOURS MUST BE BLANK OR ZERO */
 IF ^PART_ONLY
   THEN DO;
     IF PART_TRAILER
       THEN DO;
         FEDIT (S0QSVCHR,
                REQUIRED,
                NUMB,
                EQ,
                ('   ','000'),
                WARNING,051)
         IF FAIL
           THEN S0QSVCHR = '000';        /* ACTUAL HOURS             */
       END;
     ELSE                                /* NOT PART ONLY OR TRAILER */
       DO;
         IF S0CSVC ^= '08' & S0CSVC ^= '33'       /* SERVICE CODE    */
           THEN DO;
             FEDIT (S0QSVCHR,
                    REQUIRED,
                    NUM,
                    PEND,051)

             IF S0QOVTHR <= '000' &      /* OVERTIME HOURS  (HHT)   */
                S0QTRAHR <= '000'        /* TRAVEL HOURS    (HHT)   */
               THEN FEDIT (S0QSVCHR,
                      REQUIRED,
                      NUM,
                      GT,
                      ('000'),
                    PEND,051)
           END;

         IF S0CSVC = '08'                /* SERVICE CODE             */
           THEN DO;
             IF S0IPMFSA = '  '   &      /* CHANGE PM FREQUENCY      */
                S0QOVTHR <= '000' &      /* OVERTIME HOURS  (HHT)    */
                S0QTRAHR <= '000'        /* TRAVEL HOURS    (HHT)    */
               THEN FEDIT (S0QSVCHR,
                           REQUIRED,
                           NUM,
                           GT,
                           ('000'),
                           PEND,051)
           END;


         IF S0CSVC = '55' | S0CSVC = '65'      /* SERVICE CODE       */
           THEN IF S0QSVCHR_NUM > 40.0
                  THEN DO;
                    ERR_SW = ON;
                    FEDIT (ERR_SW,
                           NOTALLOWED,
                           BI,
                           EQ,
                           (ON),
                           PEND,051)    /* ACT HRS INVALID           */
                    ERR_SW = OFF;
                  END;
                  ELSE;
           ELSE ;
       END;
   END;

 END ACTUAL_HOURS;

 %PAGE;
 ALT_SHIP_BO:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  ALTERNATE SHIP B/O (140, 252)                                   */
 /*  (S0IALTRB) (Alphanumeric)                                       */
 /*  -----------------------------                                   */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 FC_FOUND = OFF;

 DO I = 1 TO 4;
   IF S0CFUNC(I) = '01'  |          /* PART FUNCTION CODE  */
      S0CFUNC(I) = '03'  |          /* PART FUNCTION CODE  */
      S0CFUNC(I) = '21'             /* PART FUNCTION CODE  */
     THEN FC_FOUND = ON;
 END;

 IF FC_FOUND
   THEN DO;
     FEDIT (S0IALTRB,
            REQUIRED,
            ALPHANB,
            WARNING,140)
     IF FAIL
       THEN S0IALTRB = '';
   END;
   ELSE DO;
   /* BLANK OUT ALT SHIP B/O AND ISSUE WARNING 252 */
     FEDIT (S0IALTRB,
            REQUIRED,
            ALPHANB,
            EQ,
            ('   '),
            WARNING,252)
     IF FAIL THEN
       S0IALTRB = '';
   END;

 END ALT_SHIP_BO;

 %PAGE;
 ASGN_SHIFT:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  ASSIGNED SHIFT (n/a)                                            */
 /*  (S0IASSFT) (Numeric/?)                                          */
 /*  -------------------------                                       */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 IF S0IASSFT ^= '1'  &
    S0IASSFT ^= '2'  &
    S0IASSFT ^= '3' 
   THEN   S0IASSFT = '?';

 END ASGN_SHIFT;

 %PAGE;
 BA_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  BILLABLE/SPECIAL ACTIVITY CODE(026, 027, 305, 306, 307, 308,309)*/
 /*  (S0CBIOSA) (Numeric)                                            */
 /*  -------------------------------------------                     */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
   SELECT;                           /* SELECT A BILLABLE CODE ERROR */
     WHEN (S0CSVC = ' ' | PART_TRAILER)/*SERVICE CODE OR PART TRAILER*/
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              (' '),
              PEND,027)

           /*SERVICE CODE AND ACTIVITY CODE */
     WHEN (S0CSVC = '01' & S0CHACT ^= '11')
       IF S0CFUNC_1 = '02' | S0CFUNC_1 = '21' |   /* FUNCTION CODE 1*/
          S0CFUNC_2 = '02' | S0CFUNC_2 = '21' |
          S0CFUNC_3 = '02' | S0CFUNC_3 = '21' |
          S0CFUNC_4 = '02' | S0CFUNC_4 = '21' 
         THEN FEDIT (S0CBIOSA,
                     REQUIRED,
                     NUMB,
                     EQ,
                     ('1','3','4',' '),
                     PEND,026)
         ELSE
           FEDIT (S0CBIOSA,
                  REQUIRED,
                  NUMB,
                  EQ,
                  ('1','3','4',' '),
                  PEND,305)

     WHEN ( (S0CSVC = '08')                                    |
            (S0CSVC = '33' &  S0CMSCM > ' '                    &
             S0CMOD  = '2' &  SUBSTR(S0CMSCM,1,5) = '   ' )    |
            (S0CSVC = '36' & (S0CHACT = '20' | S0CHACT = '24'))|
            (S0CSVC = '20' & (S0CIDM  = '1'  | S0CIDM  = '3' ) &
             S0ICSS > ' ')                                     |
            (S0CSVC = '20' & (S0CIDM  = '5')))
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              ('1','3','4',' '),
              PEND,308)

     WHEN ((S0CSVC = '20' & (S0CIDM  = '1'  | S0CIDM  = '3' ))|
           (S0CSVC = '36' & (S0CHACT = '22' | S0CHACT = '25'  |
                             S0CHACT = '68' )))
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              ('1','3','4'),
              PEND,307)

                   /* SERVICE CODE AND INSTALL/DISC/MOVE CODE       */
     WHEN (S0CSVC = '20' & (S0CIDM = '2' | S0CIDM = '4' ))
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              ('1','3',' '),
              PEND,309)

                   /* SERVICE CODE AND ACTIVITY CODE                */
     WHEN (S0CSVC = '36' & (S0CHACT = '62' | S0CHACT  = '67'))
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              ('1','3'),
              PEND,306)

     WHEN (S0CSVC = '44')
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              (' ','4'),
              PEND,263)

     WHEN (S0CSVC = '94')
       FEDIT (S0CBIOSA,
              REQUIRED,
              NUMB,
              EQ,
              (' ','3'),
              PEND,263)

     OTHERWISE
       FEDIT (S0CBIOSA,
             REQUIRED,
             NUMB,
             EQ,
             (' '),
             PEND,027)
   END;                        /* END OF SELECT BILLABLE CODE ERROR */

 END BA_CODE;

 %PAGE;
 BILL_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  BILL CODE        (023)                                          */
 /*  (S0CTAC)                                                        */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/


  IF TEST_SW
    THEN DO;
     DIAG_TEXT = 'AERULE2: BILL CODE('||S0CTAC||') VALID_BILL_CODE('
                                       ||  VALID_BILL_CODE||')';
      CALL WRITE_TO_OPER;
    END;

 /* --------------------------------------------------------------- */
 /* BILL CODE IS ONLY AVAILABLE ON A SERVICE CODE 44 QSAR           */
 /* ALSO THE VALID_BILL_CODE FLAG WILL ALWAYS BE SET TO "Y" UNLESS  */
 /* IT'S IS NOT VALIDATED UNDER THE SC 44 CONDITIONS.               */
 /* --------------------------------------------------------------- */

  IF ( S0CTAC ^= '') |  
    ( CCNTRSRC = 'B' & VALID_BILL_CODE = 'N' & CINVCNTR ^= 'E' )
  THEN DO;
    FEDIT (VALID_BILL_CODE,
           REQUIRED,
           ALPHAN,
           EQ,
           ('Y'),
           PEND,023)

   END;

 END BILL_CODE;

 %PAGE;
 BILLING_RATE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  BILLING RATE   (312)                                            */
 /*   ( S0CTAC) (NUMERIC)                                            */
 /*   -------------------                                            */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
  IF S0CSVC = '94' & SUBSTR(S0CHACT,2,1) = '4'
    THEN                                      
      FEDIT (S0CTAC,                          
             REQUIRED,                        
             NUM,                             
             GT,                              
             ('059'),                         
           PEND,312)                          
                                              
 END BILLING_RATE;

 %PAGE;
 BIN_LOC:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  BIN/ORDER#   (159, 189, 219, 239)                               */
 /*  (S0IBINLC)   (Alphanumeric)                                     */
 /*  -----------------------                                         */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 IF  S0CFUNC_1 = '06'                 /* FUNCTION CODE               */
   THEN FEDIT (S0IBINLC_1,
               REQUIRED,
               ALPHANB,
               PEND,159)

 IF S0CFUNC_2 = '06'                 /* FUNCTION CODE               */
   THEN FEDIT (S0IBINLC_2,
               REQUIRED,
               ALPHANB,
               PEND,189)

 IF S0CFUNC_3 = '06'                 /* FUNCTION CODE               */
   THEN FEDIT (S0IBINLC_3,
               REQUIRED,
               ALPHANB,
               PEND,219)

 IF S0CFUNC_4 = '06'                  /* FUNCTION CODE               */
   THEN FEDIT (S0IBINLC_4,
          REQUIRED,
          ALPHANB,
          PEND,239)

 END BIN_LOC;

 %PAGE;
 CIA_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  COMPLETION CODE (016)                                           */
 /*  (S0CCIA)  (Numeric)                                             */
 /*  ------------------------                                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 FEDIT (S0CCIA,
        REQUIRED,
        NUMB,
        PEND,016)

 IF PART_TRAILER  |
    PART_ONLY 
   THEN S0CCIA = '';
   ELSE DO;
     IF S0CSVC = '01'  |
        S0CSVC = '20'  |
        S0CSVC = '33'  
       THEN FEDIT (S0CCIA,
                   REQUIRED,
                   NUMB,
                   EQ,
                   ('1'-'6'),
                   PEND,016)
       ELSE
         IF S0CSVC = '08'  |
            S0CSVC = '36'  |
            S0CSVC = '44'  |
            S0CSVC = '47'  |
            S0CSVC = '48'  |
            S0CSVC = '94'  
           THEN
             FEDIT (S0CCIA,
                    REQUIRED,
                    NUMB,
                    EQ,
                    ('1'-'5'),
                    PEND,016)
           ELSE
             FEDIT (S0CCIA,
                    REQUIRED,
                    ALPHANB,
                    EQ,
                    (' '),
                    PEND,016)
   END;

 END CIA_CODE;

 %PAGE;
 CONTRACT:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  CSS CONTRACT  (020, 021, 028, 035, 324, 325, 326, 327)          */
 /*                (328, 329, 330, 331)                              */
 /*  (S0ICSS) (Alphanumeric)                                         */
 /*  ------------------------------------                            */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /********************************************************************/

    IF TEST_SW
      THEN DO;
        DIAG_TEXT = 'AERULE2:  CONTRACT CHECKING';
        CALL WRITE_TO_OPER;
        DIAG_TEXT ='AERULE2: CINVCNTR = ('||CINVCNTR||')S0ICSS = ('||
                    S0ICSS||') S0ICSS2 =('||S0ICSS2 ||')';
         CALL WRITE_TO_OPER;
      END;

                 /* ---------------------------------------------- */
                 /*                                                */
                 /*  IF ALL CONTRACT SEARCHES FAIL, PEND ORIGINAL  */
                 /*  CE ENTERED CONTRACT WITH CONTRACT INVALID MSG */
                 /*  SET RESET CONTRACT FLAG TO '1' AND            */
                 /*  INVALID CONTRACT FLAG TO 'A'.                 */
                 /*  S98005                                        */
                 /* ---------------------------------------------- */

 IF CINVCNTR ^= ''    &
    S0ICSS   ^= ''    &
    S0ICSS2  ^= ''    &
    S0ICSS2  ^= S0ICSS
   THEN DO;

        ERR_SW = ON;
        FEDIT (ERR_SW,
               NOTALLOWED,
               BI,
               EQ,
               (ON),
               PEND,020)
        ERR_SW = OFF;
        CINVCNTR = 'A';
        FRSTCNTR = '1'B;

   END;
   ELSE DO;
      IF TEST_SW
        THEN DO;
          DIAG_TEXT = 'AERULE2: ENTERING BMS CONTRACT AUDIT/EDITS';
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: CONTRACT NO            = '||S0ICSS;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: ACTIVITY CODE          = '||S0CHACT;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: INVALID CONTRACT FLAG  = '||CINVCNTR;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: CNTR VALIDATION LOC    = '||CCNTRSRC;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: TABLE LEVEL            = '||S0IPECLV;
          CALL WRITE_TO_OPER;
        END;

                  /* ----------------------------------------------- */
                  /*                                                 */
                  /* IF TABLE LEVEL >= 830 AND LAST LOCATION         */
                  /* VALIDATED WAS BMS AND SC = 44                   */
                  /*                                                 */
                  /* ----------------------------------------------- */
 IF CCNTRSRC   = 'B'   &
    S0CSVC     = '44'
   THEN DO;
     SELECT (CINVCNTR);             /* INVALID CONTRACT FLAG        */
       WHEN ('A')                   /* INVALID WORK NUMBER          */
         DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,333)
           ERR_SW = OFF;
         END;
       WHEN ('D')                   /* OUT OF DATE FOR WORK NUMBER  */
         DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,336)
           ERR_SW = OFF;
         END;
       WHEN ('E')                   /* OUT OF DATE FOR BILL CODE    */
         DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,335)
           ERR_SW = OFF;
         END;
       WHEN ('G')                   /* INVALID ACTIVITY             */
         DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,334)
           ERR_SW = OFF;
         END;
       WHEN ('H')                   /* INVALID DATE FOR ACTIVITY ID */
         DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,332)
           ERR_SW = OFF;
         END;
       WHEN ('J')                   /* ACTIVITY ID INVALID FOR WORK */
         DO;                        /* NUMBER                       */
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,340)
           ERR_SW = OFF;
         END;
       WHEN ('K')                   /* ACTIVITY DATE AFTER ACTIVITY */
         DO;                        /* ID CLOSE DATE                */
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,341)
           ERR_SW = OFF;
         END;
       WHEN ('L')                   /* ACTIVITY DATE AFTER ACCCOUNT */
         DO;                        /* ID (WORK NUM) FINISH DATE    */
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,355)
           ERR_SW = OFF;
         END;
       WHEN ('M')                   /* ACTIVITY DATE AFTER ACCOUNT  */
         DO;                        /* ID(WORK NUMBER) CLOSE DATE   */
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,356)
           ERR_SW = OFF;
         END;

       OTHERWISE;
     END;
               /* -------------------------------------------------- */
               /* IF THIS IS A VALID TSS ALLIANCE CONTRACT THEN THE  */
               /* ACTIVITY CODE HAS TO BE 10.                        */
               /* -------------------------------------------------- */
       IF S0CSVC    = '44'  &
          CCNTRSRC  = 'T'   &         /* INVALID ACTIVITY            */
          CINVCNTR  = ' '   &
          S0CHACT  ^= '10'
         THEN DO;
            ERR_SW = ON;
            FEDIT (ERR_SW,
                   NOTALLOWED,
                   BI,
                   EQ,
                   (ON),
                   PEND,334)
            ERR_SW = OFF;
         END;
               /* -------------------------------------------------- */
               /* IF THIS IS A 44 AND ACTIVITY CODE IS 10 THE        */
               /* THE CONTRACT MUST BE A TSS ALLIANCE CONTRACT       */
               /* ACTIVITY CODE IS INVALID                           */
               /* -------------------------------------------------- */
       IF S0CSVC    = '44'  &
          S0CHACT   = '10'  &
          CINVCNTR  = ' '   &
          CCNTRSRC ^= 'T'
            THEN DO;
              ERR_SW = ON;
              FEDIT (ERR_SW,
                     NOTALLOWED,
                     BI,
                     EQ,
                     (ON),
                     PEND,334)
              ERR_SW = OFF;
            END;
   END;
   ELSE DO;
                  /* ----------------------------------------------- */
                  /* THIS IS NOT BMS AND TABLE >= 830                */
                  /* SKIP CONTRACT AUDITS UNDER CERTAIN CONDITIONS   */
                  /*1 IF CONTRACT = 'C1090'                          */
                  /*2 IF DART QSAR AND MATCH TO INVENTORY AND SC NOT */
                  /*  44 OR 94                                       */
                  /*3 IF SPECIAL CONTRACT VALUE BUT NOT ADP99 AND SC */
                  /*  NOT 44 OR 94                                   */
                  /*4 IF ADP QSAR AND MATCH TO INVENTORY AND SC NOT  */
                  /*  44 OR 94                                       */
                  /* ----------------------------------------------- */
     IF SUBSTR(S0ICSS,1,5) = 'C1090'   |
        SUBSTR(S0ICSS,1,6) = 'YXXKB '  |
        SUBSTR(S0ICSS,1,8) = 'SC03M0Y '|
  /* (FSRCDART & M_MPI='Y' & S0CSVC ^= '44' &  S0CSVC ^= '94') | 5NSM*/
       (FSPCCNTR & SUBSTR(S0ICSS,1,5) ^= 'ADP99' & S0CSVC ^= '44')
                                       |
       (SUBSTR(S0ICSS,1,5) = 'ADP99' & M_MPI = 'Y' & S0CSVC ^= '44') 
     THEN;/*BYPASS CSS AUDT/EDITS*/
     ELSE DO;                 /* PERFORM CONTRACT NUMBER AUDIT/EDITS */
                      /* ------------------------------- */
                      /*        CONTRACT AUDITS          */
                      /* ------------------------------- */
      IF TEST_SW
        THEN DO;
          DIAG_TEXT = 'AERULE2: ENTERING CONTRACT AUDIT/EDITS';
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: CONTRACT NO            = '||S0ICSS;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: M_COS                  = '||M_COS;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: COS_VALID              = '||COS_VALID;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: ACTIVITY CODE          = '||S0CHACT;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: INVALID CONTRACT FLAG  = '||CINVCNTR;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: IS THIS AN INNNNNN CNTR= '||FIBM;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: LOC CONTRACT VALIDATED = '||CVALLOC;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: CTOOL TYPE CHECK       = '||FTYPECHK;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: MATCH TO MPI Y/N       = '||M_MPI;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: MTM MATCH TO MPI FLAG  = '||M_MPIREQ;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: HANDLE MTM INFO        = '||CMTMOVRD;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: MPI MACHINE STATUS     = '||GJCSTAT;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: OEE DATA BASE UNA      = '||FOEEUNA;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: CNTR SOURCE  CCNTRSRC  = '||CCNTRSRC;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: TABLE LEVEL            = '||S0IPECLV;
          CALL WRITE_TO_OPER;
        END;


        IF S0ICSS > ' ' & VERIFY(S0ICSS,' 9') = 0
          THEN DO;
            ERR_SW = ON;
            FEDIT (ERR_SW,
                   NOTALLOWED,
                   BI,
                   EQ,
                   (ON),
                   PEND,020)
            ERR_SW = OFF;
                       /* ALL NINES IN CONTRACT NUMBER IS NOT ALLOWED*/
          END;
        ELSE;

                      /***********************************/
                      /* ENHANCED CONTRACT ERROR CODES   */
                      /***********************************/
    /* ------------------------------------------------------------- */
    /*       WHEN (SERVICE CODE        EQUAL TO 01      OR           */
    /*             SERVICE CODE        EQUAL TO 08  )   AND          */
    /*             LOCATION OF CONTRACT CHECKING IS CEDB             */
    /* ------------------------------------------------------------- */
        IF TEST_SW
          THEN DO;
             DIAG_TEXT = 'AERULE2:  CEDB REPOSITORY CHECK';
             CALL WRITE_TO_OPER;
             DIAG_TEXT = 'CINVCNTR = ('||CINVCNTR||') CVALLOC = ('||
                          CVALLOC||') SERVICE CODE =('||S0CSVC||')';
              CALL WRITE_TO_OPER;
          END;

        IF (S0CSVC = '01' | S0CSVC = '08') & CVALLOC = '4' 
          THEN DO;                          /* CEDB contract         */
            IF TEST_SW
              THEN DO;
                DIAG_TEXT = 'AERULE2: CEDB TYPE OF CONTRACT';
                CALL WRITE_TO_OPER;
                DIAG_TEXT = 'CINVCNTR = ('||CINVCNTR||')';
                CALL WRITE_TO_OPER;
              END;

            SELECT (CINVCNTR);          /* INVALID CONTRACT FLAG     */
              WHEN ('D')                /* OUT OF DATE               */
                DO;
                   FEDIT (CINVCNTR,
                          REQUIRED,
                          ALPHAN,
                          EQ,
                          (' '),
                          PEND,327) /*CE-CNTR NOT VALID FOR ACT DATE */
                END;
            
              WHEN ('C')                /* TYPE INVALID              */
                DO;
                   FEDIT (CINVCNTR,
                          REQUIRED,
                          ALPHAN,
                          EQ,
                          (' '),
                          PEND,326)  /* TYPE NOT COVERED BY CONTRACT */
                END;
            
              WHEN ('F')              /* TYPE INVALID                */
                DO;
                   FEDIT (CINVCNTR,
                          REQUIRED,
                          ALPHAN,
                          EQ,
                          (' '),
                          PEND,331)   /*TYPE/SERIAL INVALID FOR CONT */
                END;
              WHEN ('A')              /* contract invalid            */
                DO;                   /* could not validated the     */
                  ERR_SW = ON;        /* contract anywhere           */
                                      /* Mn rec 6626829              */
                  FEDIT (ERR_SW,
                         NOTALLOWED,
                         BI,
                         EQ,
                         (ON),
                         PEND,020)
                  ERR_SW = OFF;
            
                END;
              OTHERWISE ;
            END;                   /* END OF SELECT                  */
          END;


        IF (
             (S0CSVC ^= '44' &  S0ICSS ^= ' ' ) |
             (SUBSTR(S0ICSS,1,5) = 'ADP99' & M_MPI = 'N' )   )

               & CVALLOC ^= '4'          /* CONTRACT VALIDATION OTHER*/
          THEN                           /* THAN CEDB                */
           DO;

           SELECT (CINVCNTR);          /* INVALID CONTRACT FLAG      */
            WHEN  ('A')                /* CNTR ^ FOUND AND ^CERIS    */
             DO;
               IF FIBM                /* CERIS RECORD                */
                 THEN  FEDIT (CINVCNTR,
                              REQUIRED,
                              ALPHANB,
                              EQ,
                              (' '),
                              PEND,329)
                                  /*INVALID EMP SERIAL IN CONTRACT   */
          /* ------------------------------------------------------- */
          /* WHEN (SERVICE CODE NOT EQUAL TO 44         AND          */
          /*       SERVICE CODE NOT EQUAL TO 94         AND          */
          /*       THE CONTRACT IS NOT EQUAL TO BLANK)  AND          */
          /* ------------------------------------------------------- */
                 ELSE DO;
                    ERR_SW = ON;
                    FEDIT (ERR_SW,
                           NOTALLOWED,
                           BI,
                           EQ,
                           (ON),
                           PEND,020)/*CONTRACT NUMBER MISSING/INVALID*/
                    ERR_SW = OFF;
                 END;
             END;

            WHEN ('B')            /* SERVICE INVALID                 */
              DO;
                FEDIT (CINVCNTR,
                       REQUIRED,
                       ALPHAN,
                       EQ,
                       (' '),
                       PEND,325)/* SC NOT VALID FOR CONTRACT         */
              END;

            WHEN ('C')            /* TYPE INVALID                    */
             DO; 
             /* ---------------------------------------------------- */
             /* WHEN  THERE IS A NO MATCH TO INVENTORY   OR          */
             /*       THERE IS A MATCH TO INVENTORY     AND          */
             /*       ITS A PER CALL MACHINE                         */
             /* ---------------------------------------------------- */
                 IF  ( M_MPI = 'N') |
                     ( M_MPI = 'Y' & GJCSTAT = '30')
                   THEN
                      FEDIT (CINVCNTR,
                             REQUIRED,
                             ALPHAN,
                             EQ,
                             (' '),
                             PEND,326)/* TYPE NOT COVERED BY CONTRACT*/
             END;

            WHEN ('M')                /* MODEL INVALID               */
              DO;
                FEDIT (CINVCNTR,
                       REQUIRED,
                       ALPHAN,
                       EQ,
                       (' '),
                       PEND,342)     /* MODEL NOT COVERED BY CONTRACT*/
              END;

            WHEN ('D')            /* OUT OF DATE                     */
              DO;
                FEDIT (CINVCNTR,
                       REQUIRED,
                       ALPHAN,
                       EQ,
                       (' '),
                       PEND,327)/* CE-CNTR NOT VALID FOR SERVICE DATE*/
              END;

            WHEN ('E')            /* EXPIRED                         */
              DO;
                FEDIT (CINVCNTR,
                       REQUIRED,
                       ALPHAN,
                       EQ,
                       (' '),
                       PEND,328)   /* CE- CONTRACT EXPIRED        */
              END;
            OTHERWISE;
           END;                    /* END OF SELECT                  */
           
          END;   /* END OF IF THEN                                   */

        IF S0CSVC ^= '44' &  S0ICSS ^= ' ' THEN
           IF (FPARTUSE = 'N' & S0CBIOSA ^= '3' & S0CBIOSA ^= '7' &
               CHCDATIT = 'B') & CINVCNTR = ''
            /* ----------------------------------------------------- */
            /* WHEN (PART USAGE = 'N' AND BILLABLE CODE IS NOT       */
            /*       '3' OR '7' AND THERE ARE PARTS) THEN            */
            /*       PARTS NOT ALLOWED)                              */
            /* ----------------------------------------------------- */
             THEN DO;
               ERR_SW = ON;
               FEDIT (ERR_SW,
                      NOTALLOWED,
                      BI,
                      EQ,
                     (ON),
                      PEND,324)/* PARTS NOT ALLOWED FOR THIS CONTRACT*/
               ERR_SW = OFF;
             END;

                  /* ----------------------------------------------- */
                  /* S/C 44 AND 94 RECORDS WILL BE VALIDATE AGAINST  */
                  /* THE CTOOL CONTRACT TABLE BEFORE GOING TO THE COS*/
                  /* AND SCORE TABLES IF THE CONTRACT IS FOUND ON THE*/
                  /* CTOOL TABLE THEN THERE IS NO NEED TO CHECK ON   */
                  /* THE OTHER TWO TABLES.                           */
                  /* ----------------------------------------------- */
                  /***********************************/
                  /* S/C 44 NEEDS FILLED CONTRACT NO */
                  /***********************************/
                  /* ------------------------------- */
                  /* COS CONTRACT CHECKING           */
                  /* ------------------------------- */
       IF S0CSVC = '44' 
         THEN FEDIT (S0ICSS,
                     NOTALLOWED,
                     ALPHANB,
                     EQ,
                     ('       '),
                    PEND,020)   /* CONTRACT NUMBER IS MISSING/INVALID*/

               /* -------------------------------------------------- */
               /* IF THIS IS A VALID TSS ALLIANCE CONTRACT THEN THE  */
               /* ACTIVITY CODE HAS TO BE 10.                        */
               /* -------------------------------------------------- */
       IF S0CSVC    = '44'  &
          CCNTRSRC  = 'T'   &         /* INVALID ACTIVITY            */
          CINVCNTR  = ' '   &
          S0CHACT  ^= '10'
         THEN DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,334)
           ERR_SW = OFF;
         END;
               /* -------------------------------------------------- */
               /* IF THIS IS A 44 AND ACTIVITY CODE IS 10 THE        */
               /* THE CONTRACT MUST BE A TSS ALLIANCE CONTRACT       */
               /* ACTIVITY CODE IS INVALID                           */
               /* -------------------------------------------------- */
       IF S0CSVC    = '44'  &
          S0CHACT   = '10'  &
          CINVCNTR  = ' '   &
          CCNTRSRC ^= 'T'
         THEN DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,334)
           ERR_SW = OFF;
         END;
                      /* ------------------------------- */
                      /* S/C 44 MUST HAVE A VALID CNTR   */
                      /* OTHERWISE THE RECORD WILL PEND  */
                      /* EVEN IF THE M_COS FLAG='N'      */
                      /* THIS FLAG WAS SET FOR TSS       */
                      /* ALLIANCE CONTRACTS WHICH SHOULD */
                      /* BE ON TSS ALLIANCE TABLE        */
                      /* ------------------------------- */

       IF COS_VALID = 'N'  &      /* THIS IS BEING DONE SO THAT WE   */
          CINVCNTR  = ''          /* PEND FOR COS_VALID = 'N'        */
          THEN CINVCNTR = 'A';    /* WILL BE REMOVED AFTER COS GONE  */


       IF S0CSVC = '44' & CINVCNTR = 'B' & M_COS = 'Y'
         THEN CINVCNTR = 'A';
                                  /* FOR ALL SC 44 NOT VALIDATED BY  */
                                  /* BMS CHECK CINVCNTR              */
       IF S0CSVC = '44' & CCNTRSRC  ^= 'B'
         THEN DO;
           SELECT (CINVCNTR);           /* INVALID CONTRACT FLAG     */
             WHEN ('A','B','C','F','G') /* NOT FOUND                 */
               DO;
                  FEDIT (CINVCNTR,
                         REQUIRED,
                         ALPHAN,
                         EQ,
                         (' '),
                         PEND,020) /*CE-CNTR NOT VALID               */
               END;
             WHEN ('D')                 /* OUT OF DATE               */
               DO;
                  FEDIT (CINVCNTR,
                         REQUIRED,
                         ALPHAN,
                         EQ,
                         (' '),
                         PEND,327)/*CE-CNTR NOT VALID FOR ACT DATE   */
               END;

             WHEN ('E')               /* EXPIRED                     */
               DO;
                  FEDIT (CINVCNTR,
                         REQUIRED,
                         ALPHAN,
                         EQ,
                         (' '),
                         PEND,328)     /* CE-CNTR EXPIRED            */
               END;

             OTHERWISE;
           END;                  /* END OF SELECT                    */

         END;


 /* -----------------------------------------------------------------*/
 /* ESTIMATED BILLING CONTRACT NUMBERS SHOULD BE VERIFIED IF THE CE  */
 /* WAS KNOW TO ENTER A CONTRACT NUMBER.                             */
 /* -----------------------------------------------------------------*/
 /* CNTRDIAG                                                         */
 /* VALUE                       MEANING                              */
 /* N = QSAR WAS DETERMINED NOT ELIGIBLE FOR ENHANCHED CONTRACT SEARC*/
 /* 0 = QSAR WAS ELIGIBLE, BUT NO SUCCESSFUL SEARCH WAS COMPLETED.   */
 /* 1 - USING CE CONTRACT WE FOUND A VALID CONTRACT.                 */
 /* 2 - USING CUSTOMER NUMBER FROM CE CONTRACT WE FOUND A VALID CONTR*/
 /* 3 - USING NSS CONTRACT WE FOUND A VALID CONTRACT.                */
 /* 4 - USING CUSTOMER # FROM BSS CONTRACT WE FOUND A VALID CONTRACT */
 /* 5 - USING MPI CUSTOMER # WE FOUND A VALID CONTRACT.              */
 /* -----------------------------------------------------------------*/
       IF (S0ICSS > ' ' & CNTRDIAG ^= 'N'& CVALLOC = '1')
         THEN
           FEDIT (CNTRDIAG,
                 REQUIRED,
                 ALPHAN,
                 EQ,
                 ('1','2','3','4','5'),
                 WARNING,028)
       END;
   END;
   END;                                  /* END OF NEW CONTRACT CHECK*/

  IF ( CINVCNTR ^= ''   |   /* INVALID CONTRACT OR NO CONTRACT       */
       S0ICSS    = '' ) &
      M_MPI     = 'Y'   &   /* THERE WAS AN INVENTORY MATCH          */
      ^GJFDSI           &   /* NOT A DSI MATCH                       */
      GJCPROLE  = '0'       /* AND PROCESS LEVEL CODE IS UNINSTALLED */
    THEN DO;
      IF S0CSVC = '33' & S0CMODNA = '2' /* DO NOT PEND PER KATHY     */
       THEN;                            /* GIOGLIO - did not apply   */
       ELSE DO;                         /* cannot find the machine   */
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,038)
         ERR_SW = OFF;
       END;
    END;

 END CONTRACT;

 %PAGE;
 CUSTOMER_NAME:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  CUSTOMER NAME  (298)                                            */
 /*  (S8CUSTNM) (Any Char)                                           */
 /*  -------------------------                                       */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF (S0CSVC = '01' | S0CSVC = '08') &
     S0CBIOSA ^= ''
    THEN
      FEDIT (S8CUSTNM,
             REQUIRED,
             ALPHANBS,
             GT,
             (' '),
             PEND,298)  /* CUSTOMER NAME IS REQUIRED                */
 
  IF S0CSVC = '20' & ^PART_TRAILER & S0CIDM = '1'
    THEN
      FEDIT (S8CUSTNM,
             REQUIRED,
             ALPHANBS,
             GT,
             (' '),
             PEND,298)  /* SC 20 CE ENTERED CUSTOMER NAME IS REQUIRED*/

  IF (S0CSVC = '36' | S0CSVC = '44' ) &
     S0CCIA = '1'
    THEN
      FEDIT (S8CUSTNM,
             REQUIRED,
             ALPHANBS,
             GT,
             (' '),
             PEND,298)  /* CUSTOMER NAME IS REQUIRED                 */

 END CUSTOMER_NAME;

 %PAGE;
 CUSTOMER_NUMBER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  CUSTOMER NUMBER  (313, 314)                                     */
 /*  (S0ICUST) (Alphanumeric)                                        */
 /*  ------------------------                                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF S0ICUST ^= ' ' & S0CSVC = '48' & LINKFAIL_MPI = 'N'
   THEN FEDIT (M_CMR,
               REQUIRED,
               ALPHAN,
               EQ,
               ('Y'),
               PEND,313)

 IF S0ICUST = '0000000' &  S0CSVC = '48'
   THEN DO;
     ERR_SW = ON;
     FEDIT (ERR_SW,
            NOTALLOWED,
            BI,
            EQ,
            (ON),
            PEND,313)
     ERR_SW = OFF;
   END;

 END CUSTOMER_NUMBER;


 %PAGE;
 DELIVERY_POINT:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  DELIVERY POINT (141, 253)                                       */
 /*  (S0CDELPT) - IN COMMON PART DATA (Numeric)                      */
 /*  --------------                                                  */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 IF S0CFUNC_1 = '01'  |
    S0CFUNC_1 = '03'  |
    S0CFUNC_1 = '21'  |                  /*  I 76367                 */
    S0CFUNC_2 = '01'  |
    S0CFUNC_2 = '03'  |
    S0CFUNC_2 = '21'  |
    S0CFUNC_3 = '01'  |
    S0CFUNC_3 = '03'  |
    S0CFUNC_3 = '21'  |
    S0CFUNC_4 = '01'  |
    S0CFUNC_4 = '03'  |
    S0CFUNC_4 = '21' 
   THEN DO;
     FEDIT (S0CDELPT,
            REQUIRED,
            ALPHANB,
            WARNING,141)                           /* I 76127*/
     IF FAIL
       THEN S0CDELPT = '';
   END;
   ELSE DO;
     FEDIT (S0CDELPT,
            REQUIRED,
            ALPHANB,
            EQ,
            ('  '),
            WARNING,253)                         /* I 76367          */
     IF FAIL
       THEN S0CDELPT = '';
   END;

 END DELIVERY_POINT;

 %PAGE;
 DIS_PART_QTY:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  DISBURSE/USAGE. PART QUANTITY  (160, 29, 220, 240)              */
 /*  (S0QDISUS(4))  (Numeric)                                        */
 /*  ------------------                                              */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 /* EDIT PART LINE 1 */

 IF S0CFUNC_1 = '01'  |
    S0CFUNC_1 = '02'  |
    S0CFUNC_1 = '09'  |
    S0CFUNC_1 = '10'  |
    S0CFUNC_1 = '21' 
   THEN
     FEDIT (S0QDISUS_1,
            REQUIRED,
            NUM,
            EQ,
            ('01'-'99'),
            PEND,160)
   ELSE
     IF S0CFUNC_1 = '03'    |
        S0CFUNC_1 = '99' 
       THEN
         FEDIT (S0QDISUS_1,
                REQUIRED,
                ALPHANB,
                EQ,
                ('  ','00'),
                PEND,160)
       ELSE
         IF S0CFUNC_1 = '06' 
           THEN
              FEDIT (S0QDISUS_1,
                     REQUIRED,
                     NUM,
                     EQ,
                     ('00'-'99'),
                     PEND,160)


 /*IF ( S0CFUNC_1 = '02' | S0CFUNC_1 = '21' ) &
      CGPART1T(1) = 'R'  &   
      USA
   THEN
     FEDIT (S0QDISUS_1,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,160)  */
     

 /* EDIT PART LINE 2 */

 IF S0CFUNC_2 = '01'  |
    S0CFUNC_2 = '02'  |
    S0CFUNC_2 = '09'  |
    S0CFUNC_2 = '10'  |
    S0CFUNC_2 = '21' 
  THEN
    FEDIT (S0QDISUS_2,
           REQUIRED,
           NUM,
           EQ,
           ('01'-'99'),
           PEND,190)
  ELSE
    IF S0CFUNC_2 = '03'  |
       S0CFUNC_2 = '99'
      THEN FEDIT (S0QDISUS_2,
                  REQUIRED,
                  ALPHANB,
                  EQ,
                  ('  ','00'),
                  PEND,190)
      ELSE
        IF S0CFUNC_2 = '06' 
          THEN
             FEDIT (S0QDISUS_2,
             REQUIRED,
             NUM,
             EQ,
             ('00'-'99'),
             PEND,190)


 /* IF ( S0CFUNC_2 = '02' | S0CFUNC_2 = '21' ) &
      CGPART1T(2) = 'R'  &   
      USA
   THEN
     FEDIT (S0QDISUS_2,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,190)  */

 /* EDIT PART LINE 3 */

 IF S0CFUNC_3 = '01'  |
    S0CFUNC_3 = '02'  |
    S0CFUNC_3 = '09'  |
    S0CFUNC_3 = '10'  |
    S0CFUNC_3 = '21' 
   THEN
     FEDIT (S0QDISUS_3,
            REQUIRED,
            NUM,
            EQ,
            ('01'-'99'),
            PEND,220)
   ELSE IF S0CFUNC_3 = '03'  |
           S0CFUNC_3 = '99' 
          THEN
            FEDIT (S0QDISUS_3,
                   REQUIRED,
                   ALPHANB,
                   EQ,
                   ('  ','00'),
                   PEND,220)
          ELSE IF S0CFUNC_3 = '06' 
                 THEN
                   FEDIT (S0QDISUS_3,
                          REQUIRED,
                          NUM,
                          EQ,
                          ('00'-'99'),
                          PEND,220)


 /* IF ( S0CFUNC_3 = '02' | S0CFUNC_3 = '21' ) &
      CGPART1T(3) = 'R'  &    
      USA
   THEN
     FEDIT (S0QDISUS_3,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,220)  */


 /* EDIT PART LINE 4 */

 IF S0CFUNC_4 = '01'  |
    S0CFUNC_4 = '02'  |
    S0CFUNC_4 = '09'  |
    S0CFUNC_4 = '10'  |
    S0CFUNC_4 = '21' 
   THEN
     FEDIT (S0QDISUS_4,
            REQUIRED,
            NUM,
            EQ,
            ('01'-'99'),
            PEND,240)
   ELSE IF S0CFUNC_4 = '03'   |
           S0CFUNC_4 = '99' 
          THEN
            FEDIT (S0QDISUS_4,
                   REQUIRED,
                   ALPHANB,
                   EQ,
                   ('  ','00'),
                   PEND,240)
          ELSE IF S0CFUNC_4 = '06' 
                 THEN
                   FEDIT (S0QDISUS_4,
                          REQUIRED,
                          NUM,
                          EQ,
                          ('00'-'99'),
                          PEND,240)



 /* IF ( S0CFUNC_4 = '02' | S0CFUNC_4 = '21' ) &
      CGPART1T(4) = 'R'  &    
      USA
   THEN
     FEDIT (S0QDISUS_4,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,240)   */


 END DIS_PART_QTY;

 %PAGE;
 DOWNLEVEL_CHECK:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  DOWNLEVEL INDICATOR  (022)                                      */
 /*  S0IBRGFG  (Alphanumeric)                                        */
 /*  --------                                                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 IF S0ISRCPT  &                              /* SOURCED FROM PT      */
    ^S0IRESUB &                              /* RESUBMIT DOCUMENT    */
    NSDC_MULTRESUB ^= 'Y'                    /* QSAR/C MULTI RESUBMIT*/
   THEN DO;                              /* PT DOWNLEVEL CHECK       */
     FEDIT (S0IBRGFG,
            NOTALLOWED,
            ALPHANB,
            EQ,
            ('L'),
            WARNING,022)

   END;

 END DOWNLEVEL_CHECK;

 %PAGE;
 EMP_SER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  EMPLOYEE SERIAL (013, 014)                                      */
 /*  (S0IEMPSE)      (ALPHANUMERIC)                                  */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
                                        /* I80364                    */
   FEDIT (S0IEMPSE,
          REQUIRED,
          ALPHAN,
          PEND,013)

   FEDIT (M_FEDF,
          REQUIRED,
          ALPHAN,
          EQ,
          ('Y'),
          PEND,014)

 END EMP_SER;

 %PAGE;
 EXPENSE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  EXPENSE (080)                                                   */
 /*  (S0ATRAEX)                                                      */
 /*  ------------------                                              */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

   IF  ^PART_TRAILER
     THEN IF S0CSVC ^= '65'                    /* EXPENSE IS INVALID */
       THEN FEDIT (S0ATRAEX,
              REQUIRED,
              NUMB,
              PEND,080)

 /*IF ( S0CSVC = '65' ) THEN         */
 /*  DO                              */    /* EXPENSE IS NOT ALLOWED */
 /*    FEDIT (S0ATRAEX,              */
 /*           REQUIRED,              */
 /*           ALPHANB,               */
 /*           EQ,                    */
 /*           ('    '),              */
 /*           WARNING,081)            */
 /*    IF FAIL THEN                  */
 /*      S0ATRAEX = ''               */
 /*  END                             */

 END EXPENSE;

 %PAGE;
 FROM_BO:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  FROM BRANCH OFFICE (144, 254)                                   */
 /*  ( S0ISENBO )                                                    */
 /*  -------------------------------                                 */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

   IF ( S0CFUNC_1 = '01'  |
        S0CFUNC_1 = '03'  |
        S0CFUNC_1 = '04'  |
        S0CFUNC_1 = '06'  |
        S0CFUNC_1 = '21'  |
        S0CFUNC_1 = '99'  |
        S0CFUNC_2 = '01'  |
        S0CFUNC_2 = '03'  |
        S0CFUNC_2 = '04'  |
        S0CFUNC_2 = '06'  |
        S0CFUNC_2 = '21'  |
        S0CFUNC_2 = '99'  |
        S0CFUNC_3 = '01'  |
        S0CFUNC_3 = '03'  |
        S0CFUNC_3 = '04'  |
        S0CFUNC_3 = '06'  |
        S0CFUNC_3 = '21'  |
        S0CFUNC_3 = '99'  |
        S0CFUNC_4 = '01'  |
        S0CFUNC_4 = '03'  |
        S0CFUNC_4 = '04'  |
        S0CFUNC_4 = '06'  |
        S0CFUNC_4 = '21'  |
        S0CFUNC_4 = '99'    ) & FPARTVAL
    THEN DO;
       FEDIT (S0ISENBO,
              REQUIRED,
              ALPHAN,
              PEND,142)
       IF ^FAIL
         THEN
           FEDIT (M_FROMBO,
                  REQUIRED,
                  ALPHAN,
                  EQ,
                  ('Y'),
                  PEND,144)
    END;
    ELSE DO;
      IF FPARTVAL
        THEN DO;
          FEDIT (S0ISENBO,
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 ('   '),
                 WARNING,254)
          IF FAIL
            THEN S0ISENBO = '';
        END;
        ELSE;
   END;

 END FROM_BO;

 %PAGE;
 FROM_OL:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  FROM OUTSIDE LOCATION (143, 145, 255, 256)                      */
 /*  ( S0ISENOL )                                                    */
 /*  ----------------------------------                              */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
      IF TEST_SW
        THEN DO;
          DIAG_TEXT = 'AERULE2: ENTERING From OL AUDIT/EDITS';
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: M_FROMOL            = '||M_FROMOL;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOLINVAL_1          = '||FOLINVAL_1;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOLINVAL_2          = '||FOLINVAL_2;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOLINVAL_3          = '||FOLINVAL_3;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOLINVAL_4          = '||FOLINVAL_4;
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOEMFLAG(1)         = '||FOEMFLAG(1);
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOEMFLAG(2)         = '||FOEMFLAG(2);
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOEMFLAG(3)         = '||FOEMFLAG(3);
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FOEMFLAG(4)         = '||FOEMFLAG(4);
          CALL WRITE_TO_OPER;
          DIAG_TEXT = 'AERULE2: FPARTVAL            = '||FPARTVAL;
          CALL WRITE_TO_OPER;
        END;

 IF ( S0CFUNC_1 = '01'  |
      S0CFUNC_1 = '03'  |
      S0CFUNC_1 = '04'  |
      S0CFUNC_1 = '06'  |
      S0CFUNC_1 = '21'  |
      S0CFUNC_1 = '99'  |
      S0CFUNC_2 = '01'  |
      S0CFUNC_2 = '03'  |
      S0CFUNC_2 = '04'  |
      S0CFUNC_2 = '06'  |
      S0CFUNC_2 = '21'  |
      S0CFUNC_2 = '99'  |
      S0CFUNC_3 = '01'  |
      S0CFUNC_3 = '03'  |
      S0CFUNC_3 = '04'  |
      S0CFUNC_3 = '06'  |
      S0CFUNC_3 = '21'  |
      S0CFUNC_3 = '99'  |
      S0CFUNC_4 = '01'  |
      S0CFUNC_4 = '03'  |
      S0CFUNC_4 = '04'  |
      S0CFUNC_4 = '06'  |
      S0CFUNC_4 = '21'  |
      S0CFUNC_4 = '99'   )  & FPARTVAL
   THEN DO;
     FEDIT (S0ISENOL,
            REQUIRED,
            NUM,
            PEND,143)

     IF ^FAIL
       THEN
         FEDIT (M_FROMOL,
                REQUIRED,
                ALPHAN,
                EQ,
                ('Y'),
                PEND, 145)
   END;
   ELSE DO;
     IF FPARTVAL
       THEN DO;
         FEDIT (S0ISENOL,
                REQUIRED,
                ALPHANB,
                EQ,
                ('   '),
                WARNING,255)
         
         IF FAIL
           THEN S0ISENOL = '';
       END;
       ELSE;
   END;

                                  /***********************************/
                                  /* IF COLINVALID FLAG SET FOR ANY  */
                                  /* PART LINE AND FC = '03' OR      */
                                  /* FC = '01' AND FROM OL < '500'   */
                                  /* WE NEED TO PEND WITH A 256      */
                                  /* ------S9600489                  */
                                  /***********************************/


 /* ---------------------------------------------------------------- */
 /* Taken out because there is a loop that causes a pend condition   */
 /* That can only be corrected via pt correction. QAR on line can not*/
 /* correct this error.                            09/4/2002         */
 /* ---------------------------------------------------------------- */
 /* IF (S0CFUNC_1 = '01' & FOLINVAL_1 = 'Y' & S0ISENOL < '500') |    */
 /*    (S0CFUNC_2 = '01' & FOLINVAL_2 = 'Y' & S0ISENOL < '500') |    */
 /*    (S0CFUNC_2 = '01' & FOLINVAL_2 = 'Y' & S0ISENOL < '500') |    */
 /*    (S0CFUNC_3 = '01' & FOLINVAL_3 = 'Y' & S0ISENOL < '500') |    */
 /*    (S0CFUNC_4 = '01' & FOLINVAL_4 = 'Y' & S0ISENOL < '500') |    */
 /*    (S0CFUNC_1 = '03' & FOLINVAL_1 = 'Y' )                   |    */
 /*    (S0CFUNC_2 = '03' & FOLINVAL_2 = 'Y' )                   |    */
 /*    (S0CFUNC_3 = '03' & FOLINVAL_3 = 'Y' )                   |    */
 /*    (S0CFUNC_4 = '03' & FOLINVAL_4 = 'Y' )                        */
 /*    THEN  DO                                                      */
 /*       ERR_SW = ON                    according to Debbie Mesler  */
 /*       FEDIT (ERR_SW,                 the owner = CE or AU is no  */
 /*              NOTALLOWED,             longer valid                */
 /*              BI,                                                 */
 /*              EQ,                                                 */
 /*              (ON),                                               */
 /*              PEND,256)                                           */
 /*       ERR_SW = OFF                                               */
 /*    END                                                           */
 /* ---------------------------------------------------------------- */
 /* ELSE                                                             */
 /*  IF (S0CFUNC_1 = '03' & S0ISENOL > '496' & FOLINVAL_1 ^= '3') |  */
 /*     (S0CFUNC_2 = '03' & S0ISENOL > '496' & FOLINVAL_1 ^= '3') |  */
 /*     (S0CFUNC_3 = '03' & S0ISENOL > '496' & FOLINVAL_1 ^= '3') |  */
 /*     (S0CFUNC_4 = '03' & S0ISENOL > '496' & FOLINVAL_1 ^= '3')    */
 /*      THEN                                                        */
 /*       DO                                                         */
 /*         ERR_SW = ON                                              */
 /*         FEDIT (ERR_SW,                                           */
 /*                NOTALLOWED,                                       */
 /*                BI,                                               */
 /*                EQ,                                               */
 /*                (ON),                                             */
 /*                PEND,143)                                         */
 /*         ERR_SW = OFF                                             */
 /*       END                                                        */
 /*                                                                  */
 /* ---------------------------------------------------------------- */

   IF (S0CFUNC_1 = '03' & S0ISENOL > '496')       |   /* do order to */
      (S0CFUNC_2 = '03' & S0ISENOL > '496')       |   /* an expense  */
      (S0CFUNC_3 = '03' & S0ISENOL > '496')       |   /* OL          */
      (S0CFUNC_4 = '03' & S0ISENOL > '496')       |
      (S0CFUNC_1 = '21' & S0ISENOL > '496')       |
      (S0CFUNC_2 = '21' & S0ISENOL > '496')       |
      (S0CFUNC_3 = '21' & S0ISENOL > '496')       |
      (S0CFUNC_4 = '21' & S0ISENOL > '496')
     THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,143)
          ERR_SW = OFF;
        END;

   IF ((S0CFUNC_1 = '99' & S0ISENOL < '500')       |  /* do not return*/
       (S0CFUNC_2 = '99' & S0ISENOL < '500')       |  /* from invent  */
       (S0CFUNC_3 = '99' & S0ISENOL < '500')       |  /* OL           */
       (S0CFUNC_4 = '99' & S0ISENOL < '500')   ) & FPARTVAL
     THEN DO;
       ERR_SW = ON;
       FEDIT (ERR_SW,
              NOTALLOWED,
              BI,
              EQ,
              (ON),
              PEND,143)
       ERR_SW = OFF;
     END;

 END FROM_OL;

 %PAGE;
 FUNC_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PART FUNCTION CODE  (226, 230, 246)                             */
 /*                      (146, 147, 148, 150, 167, 180, 196, 210)    */
 /*  ( S0CFUNC )                                                     */
 /*  ------------------------------                                  */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /*  FUNCTION CODE/PART ACTIVITY                                     */
 /*   01 OUTSIDE LOCATION TRANSFER                                   */
 /*   02 PART USAGE                                                  */
 /*   03 PART ORDER                                                  */
 /*   04 NEW PART RETURN                                             */
 /*   06 BIN LOCATION TRANSFER  05 FROM PET IS CONVERTED TO 06 @ HOST*/
 /*   09 NOT MY PART                                                 */
 /*   10 DID NOT RECEIVE PART                                        */
 /*   21 DISBURSE AND USE PARTS                                      */
 /*   99 NEW DEFECTIVE PART RETURN                                   */
 /********************************************************************/

 IF OEMPART_1 > ' '
   THEN
     FEDIT (S0CFUNC_1,
            REQUIRED,
            NUM,
            EQ,
            ('01','02','03','04','06','09','10','21','99'),
            PEND,150)

 IF OEMPART_2 > ' '
   THEN
     FEDIT (S0CFUNC_2,
            REQUIRED,
            NUM,
            EQ,
            ('01','02','03','04','06','09','10','21','99'),
            PEND,180)

 IF OEMPART_3 > ' '
   THEN
     FEDIT (S0CFUNC_3,
            REQUIRED,
            NUM,
            EQ,
            ('01','02','03','04','06','09','10','21','99'),
            PEND,210)

 IF OEMPART_4 > ' '
   THEN
     FEDIT (S0CFUNC_4,
            REQUIRED,
            NUM,
            EQ,
            ('01','02','03','04','06','09','10','21','99'),
            PEND,230)

 /* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */
 /* IF A SERVICE CODE IS PRESENT THEN IT MUST EITHER BE A IR OR PT    */
 /* TYPE OF RECORD. ONLY CHECK FOR FUNCTION CODES 03 AND 06 FOR       */
 /* DETERMINING WHICH FUNCTION CODES ARE ALLOWED ON A PART ONLY RECORD*/
 /* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */

 IF S0CSVC >= '01'                            /* IF PT OR IR (NOT PO) */
   THEN DO;
     FEDIT (S0CFUNC_1,
            NOTALLOWED,
            NUMB,
            EQ,
            ('03','06'),
            PEND,150)             /* FUNCTION CODE 01 WAS REMOVED */
     FEDIT (S0CFUNC_2,
            NOTALLOWED,
            NUMB,
            EQ,
            ('03','06'),
            PEND,180)             /* FUNCTION CODE 01 WAS REMOVED */
     FEDIT (S0CFUNC_3,
            NOTALLOWED,
            NUMB,
            EQ,
            ('03','06'),
            PEND,210)             /* FUNCTION CODE 01 WAS REMOVED */
     FEDIT (S0CFUNC_4,
            NOTALLOWED,
            NUMB,
            EQ,
            ('03','06'),
            PEND,230)             /* FUNCTION CODE 01 WAS REMOVED */
   END;

 IF S0CSVC = '44'  |
    S0CSVC = '48'  |
    S0CSVC = '55'  |
    S0CSVC = '65'  
   THEN DO;
     FEDIT (S0CFUNC_1,
            REQUIRED,
            NUMB,
            EQ,
            ('  '),
            PEND,167)
     FEDIT (S0CFUNC_2,
            REQUIRED,
            NUMB,
            EQ,
            ('  '),
            PEND,196)
     FEDIT (S0CFUNC_3,
            REQUIRED,
            NUMB,
            EQ,
            ('  '),
            PEND,226)
     FEDIT (S0CFUNC_4,
            REQUIRED,
            NUMB,
            EQ,
            ('  '),
            PEND,246)
   END;

 IF S0CSVC = '47'
   THEN DO;
     FEDIT (S0CFUNC_1,
            REQUIRED,
            NUMB,
            EQ,
            ('  ','01','02','04','09','10','21','99'),
            PEND,150)
     FEDIT (S0CFUNC_2,
            REQUIRED,
            NUMB,
            EQ,
            ('  ','01','02','04','09','10','21','99'),
            PEND,180)
     FEDIT (S0CFUNC_3,
            REQUIRED,
            NUMB,
            EQ,
            ('  ','01','02','04','09','10','21','99'),
            PEND,210)
     FEDIT (S0CFUNC_4,
            REQUIRED,
            NUMB,
            EQ,
            ('  ','01','02','04','09','10','21','99'),
            PEND,230)
   END;

  END FUNC_CODE;

 %PAGE;
 IDM_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  INSTALL/DISCONTINUE/MOVE CODE (046, 047))                       */
 /*  ( S0CIDM)                                                       */
 /*  ----------------------------------------                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /*  1 = Installation Planning.                                      */
 /*  2 = Initial Installation.                                       */
 /*  3 = Relocate, Rearrange or Customer Setup.                      */
 /*  4 = Disassemble, Pack, or Transport.                            */
 /*  5 = Marketing Promotion Disassemble Machine for return to IBM.  */
 /*                                                                  */
 /********************************************************************/

 IF S0CSVC = '20'
   THEN DO;
     FEDIT (S0CIDM,
            REQUIRED,
            NUM,
            EQ,
            ('1'-'5'),
            WARNING,046)

     IF (S0CIDM = '2' & CGFAUTIN )
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,047)
          ERR_SW = OFF;
       END;
   END;
   ELSE
     FEDIT (S0CIDM,
            REQUIRED,
            ALPHANB,
            EQ,
            (' '),
            WARNING,046)

 END IDM_CODE;

 %PAGE;
 MACHSER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  MACHINE SERIAL  (011, 111, 012, 010, 004)                       */
 /*  S0IMACSE(22) or TEMP_SERIAL(7)                                  */
 /*  ------------------------------------------------                */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 MACHSER_BYPASS = OFF;
 IF TEST_SW
    THEN DO;
      DIAG_TEXT = 'AERULE2: 1 MACHSER_BYPASS = '||MACHSER_BYPASS;
      CALL WRITE_TO_OPER;
    END;


 IF (FIBM)                                                    |
    (LINKFAIL_MPI = 'Y')                                      |
    (FSEROVRD = 'Y')                                          |
    (S0CSVC = '55' | S0CSVC = '65')                           |
    (S0CSVC = '08' & SUBSTR(TEMP_SERIAL,1,5) = 'XXXXX'        |
                     SUBSTR(TEMP_SERIAL,1,7) = '00XXXXX')     |
    (S0CSVC = '08' & (S0IMACTC = '901X' | S0IMACTC = '9999')) |
    (S0CSVC = '20' )                                          |
    (S0CSVC = '44' )                                          |
    (S0CSVC = '33'  & S0CMODNA = '2')   /*  SR 020046               */
    THEN DO;
    /*   (S0CSVC = '20' & S0CIDM = '1' )       |     d hoffman      */
    /*  ((S0CSVC = '44' & S0IMACTC = '9999') &       2nsg lbs       */
    /*  (TEMP_SERIAL = '0099999' | TEMP_SERIAL = '9999999' ))  THEN */
     MACHSER_BYPASS = ON;
     IF TEST_SW
      THEN DO;
       DIAG_TEXT = 'AERULE2: 2 MACHSER_BYPASS = '||MACHSER_BYPASS;
       CALL WRITE_TO_OPER;
      END;
    END;

    IF TEST_SW
     THEN DO;
       DIAG_TEXT = 'AERULE2: CEDB T/S FOUND   FCEDBTS  = '||FCEDBTS;
       CALL WRITE_TO_OPER;
       DIAG_TEXT = 'AERULE2: MTM OVERRIDE     CMTMOVRD = '||CMTMOVRD;
       CALL WRITE_TO_OPER;
       DIAG_TEXT = 'AERULE2: CNTR ERROR       CINVCNTR = '||CINVCNTR;
       CALL WRITE_TO_OPER;
       DIAG_TEXT = 'AERULE2: MATCH TO MPI REQ M_MPIREQ = '||M_MPIREQ;
       CALL WRITE_TO_OPER;
       DIAG_TEXT = 'AERULE2: MATCH TO MPI     M_MPI    = '||M_MPI;
       CALL WRITE_TO_OPER;
       DIAG_TEXT = 'AERULE2: CEDB HV CONTRACT FHVCNTR  = '||FHVCNTR;
       CALL WRITE_TO_OPER;
       DIAG_TEXT = 'AERULE2: FOEE NSS RECORD           = '||FOEE;
       CALL WRITE_TO_OPER;
      END;

    /* ************************************************************ */
    /* IF THE MACHINE IS NOT SET TO BYPASS THE INVENTORY            */
    /*    CHECKS AND THE MACHINE SERIAL IS NOT BLANK    THEN        */
    /*   - LOOK AT MTM FIELD THAT TELLS WHETHER A MATCH TO          */
    /*     MPI IS NEEDED AND THE TYPE/SERIAL WAS NOT FOUND ON CEDB  */
    /*     AND NEGATE THE FOLLOWING:                                */
    /*     ( IF THE CTOOL FIELD MTM OVERRIDE EQUAL NEVER AND        */
    /*       THE ENHANCHED CONTRACT DID NOT RETURN AN ERROR)        */
    /* OR (4NSC)                                                    */
    /* A match to MPI was required by MTM but one wasn't made and   */
    /* it a CEDB/CHIS HV type contract                         and  */
    /* it a valid CEDB/CHIS contract.                               */
    /* ************************************************************ */


 IF MACHSER_BYPASS = OFF & S0IMACSE ^= ' ' THEN
   IF (M_MPIREQ = 'Y' & FCEDBTS ^= 'Y' &
       ^(CMTMOVRD = 'NEVER' & CINVCNTR = ' ')) &
      ^(M_MPIREQ = 'Y' & M_MPI = 'N' & FHVCNTR = 'Y' & CINVCNTR = ' ')&
      ^(M_MPIREQ = 'Y' & M_MPI = 'N' & FOEE & CINVCNTR = ' ')
     THEN
       FEDIT (M_MPI,
              REQUIRED,
              ALPHAN,
              EQ,
              ('Y'),
              PEND,011)
     ELSE
    /* ***************************************************** */
    /* WHEN  THE CTOOL MTM OVERIDE FIELD = 'ALWAYS') AND     */
    /*       THERE MTM FLAG SAYS TO NO MATCH REQUIRED        */
    /*       TO MPI AND THERE IS NO MATCH TO MPI             */
    /* ***************************************************** */
       IF (CMTMOVRD  = 'ALWAYS' & M_MPIREQ = 'N' &
           M_MPI     = 'N'      & CINVCNTR = ' ')   THEN
          DO;
            ERR_SW = ON;
            FEDIT (ERR_SW,
                   NOTALLOWED,
                   BI,
                   EQ,
                  (ON),
                   PEND,330)   /*TYPE/SERIAL NOT ON FILE FOR CONTRACT*/
            ERR_SW = OFF;
          END;
       ELSE
          FEDIT (M_MPI,
                 REQUIRED,
                 ALPHAN,
                 EQ,
                 ('Y'),
                 WARNING,111)
 ELSE;

 IF S0CSVC   ^= '47' &
   (S0CFUNC_1 = '02' | S0CFUNC_2 = '02' |
    S0CFUNC_3 = '02' | S0CFUNC_4 = '02' |

    S0CFUNC_1 = '21' | S0CFUNC_2 = '21' |
    S0CFUNC_3 = '21' | S0CFUNC_4 = '21' |

  ((S0CFUNC_1 = '99' | S0CFUNC_2 = '99' |
    S0CFUNC_3 = '99' | S0CFUNC_4 = '99') & ^PART_ONLY))
  THEN
     FEDIT (S0IMACSE,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,010)

 IF S0CSVC = '44' | 
    S0CSVC = '47'
   THEN
     IF S0IMACTC = ' '
       THEN DO;
         FEDIT (S0IMACSE,
                REQUIRED,
                ALPHANB,
                EQ,
                (' '),
                WARNING,012)
         S0IMACSE    = ' ';
         TEMP_SERIAL = ' ';
       END;

 IF PART_TRAILER & S0CSVC ^= '36' & S0CSVC ^= '47'
   THEN
     FEDIT (S0IMACSE,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,010)


 IF ^PART_TRAILER &
   (S0CSVC = '01' | S0CSVC = '08' | S0CSVC = '33' | S0CSVC = '36')
   THEN
     FEDIT (S0IMACSE,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,010)

 IF S0CSVC = '20' & S0CIDM ^= '1'
   THEN
     FEDIT (S0IMACSE,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,010)

 IF S0CSVC = '55' | S0CSVC = '65'
   THEN DO;
     FEDIT (S0IMACSE,
            REQUIRED,
            ALPHANB,
            EQ,
            (' '),
            WARNING,012)
     S0IMACSE    = ' ';
     TEMP_SERIAL = ' ';
   END;

  IF TEST_SW
    THEN DO;
      DIAG_TEXT = 'AERULE2: ENTERING CONTRACT MACHINE AUDIT/EDITS';
      CALL WRITE_TO_OPER;
      DIAG_TEXT = 'AERULE2: MACHINE SERIAL         = '||S0IMACSE;
      CALL WRITE_TO_OPER;
      DIAG_TEXT = 'AERULE2: MACH SERIAL LENGTH REQ = '||FMTYPCHK;
      CALL WRITE_TO_OPER;
      DIAG_TEXT = 'AERULE2: MACH SERIAL LENGTH MIN = '||QMSERMIN;
      CALL WRITE_TO_OPER;
      DIAG_TEXT = 'AERULE2: MACH SERIAL LENGTH MAX = '||QMSERMAX;
      CALL WRITE_TO_OPER;
      DIAG_TEXT = 'AERULE2: MACH SERIAL LENGTH     = '||
                   INDEX (S0IMACSE,' ')-1;
      CALL WRITE_TO_OPER;
    END;

  /*****************************************************************/
  /* CHECK THE LENGTH OF MACHINE TYPES THAT ARE ON THE OEM MACHINE */
  /* TYPE LIST THAT NEEDS TO HAVE THE LENGTH OF THE MACHINE SERIAL */
  /* VERIFIED.                                                     */
  /*****************************************************************/
 IF FMTYPCHK = 'Y'
   THEN DO;
       ERR_SW = ON;
       DCL MSLEN FIXED BIN(15)   INIT(0);
       DCL PICLEN      PIC '99'  INIT(0);
       MSLEN = INDEX(S0IMACSE,' ');
       IF MSLEN = 0       /* NO BLANK IN THE MACHINE SERIAL FIELD    */
         THEN PICLEN = 22;
         ELSE PICLEN = MSLEN -1; /* THE INDEX IS POINTING TO THE     */
                                 /* BLANK CHARACTER                  */
       IF PICLEN >= QMSERMIN &
          PICLEN <= QMSERMAX
                          /* THE LENGTH IS NOT WITHIN THE RANGE      */
         THEN ERR_SW = OFF;

       FEDIT (ERR_SW,
              NOTALLOWED,
              BI,
              EQ,
              (ON),
              PEND,004)
       ERR_SW = OFF;
    END;

 END MACHSER;

 %PAGE;
 MACHTYPE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  MACHINE TYPE  (007, 009, 008, 005, 006, 194, 224, 244)          */
 /*   ( S0IMACTC )                                                   */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 /* ---------------------------------------------------------------- */
 /* AUDIT FOR PRODUCT ID VALUE IN MACHINE TYPE FIELD,                */
 /* PRODUCT ID VALUES ARE NOT ALLOWED IN THE MACHINE TYPE FIELD      */
 /* (BYPASS THIS AUDIT FOR ROLM AND PENNANT CE'S)     SR1121 - ABM   */
 /* THIS NEEDS TO BE REMOVED AFTER TABLE 730 EXPIES            MKP   */
 /* ---------------------------------------------------------------- */

   IF (S0IMACTC > '') &
      (CICCEACP ^= 'P')
     THEN
       FEDIT (MT_IS_PRODID,
              REQUIRED,
              ALPHAN,
              NE,
              ('Y'),
             PEND,007)
   
   MACHTYPE_BYPASS = OFF;
    IF TEST_SW
      THEN DO;
        DIAG_TEXT = 'AERULE2: 1 MACHTYPE_BYPASS = '||MACHTYPE_BYPASS;
        CALL WRITE_TO_OPER;
      END;
   
   
   IF ( S0CSVC = '44' ) |
     (( S0CSVC = '47' ) & (S0IMACTC = '9999'))                    |
     (( S0CSVC = '47' ) & (S0IMACTC = '') & CWA_COUNTRY_CODE = 'CA') |
      ( S0CSVC = '55' ) |
      ( S0CSVC = '65' ) |
      ( PART_ONLY )
     THEN DO;
       MACHTYPE_BYPASS = ON;
       IF TEST_SW
         THEN DO;
          DIAG_TEXT = 'AERULE2: 2 MACHTYPE_BYPASS = '||MACHTYPE_BYPASS;
          CALL WRITE_TO_OPER;
         END;
     END;
   
                                         /* ------------------------  */
                                         /* IF THE MACHINE IS NOT     */
                                         /* ON INVENTORY OR THE ISC   */
                                         /* LINK TO MPI INVENTORY IS  */
                                         /* DOWN, DON'T PUT THE MTM   */
                                         /* ERROR IN THE ERROR ARRAY  */
                                         /* ------------------------  */
   DO I = 1 TO HBOUND(CGQERRSE,1);       /* I 78455                   */
     IF CGIERRMS(I) = 11 | CGIERRMS(I) = 15
       THEN DO;
         MACHTYPE_BYPASS = ON;
         IF TEST_SW
          THEN DO;
           DIAG_TEXT = 'AERULE2: 3 MACHTYPE_BYPASS = '||
                                 MACHTYPE_BYPASS;
           CALL WRITE_TO_OPER;
          END;
       END;
   END;

   IF TEST_SW
     THEN DO;
       DIAG_TEXT = 'AERULE2: MACHTYPE,55/65 CHECK '||
                                  S0CSVC ||' '||S0CFUNC_1;
       CALL WRITE_TO_OPER;
     END;

   IF S0CSVC = '55'  |  
      S0CSVC = '65'
     THEN DO;
   
       FEDIT (S0IMACTC,
              REQUIRED,
              ALPHANB,
              EQ,
              ('       '),
              WARNING,009)
   
       S0IMACTC = '';
     END;
   ELSE DO;
   /*IF ( ^PART_ONLY  &  S0CSVC ^= '44' & S0CSVC ^= 94) |             */
   /*    ( S0CFUNC_1 = '01' ) |                                       */
   /*    ( S0CFUNC_1 = '02' ) |                                       */
   /*    ( S0CFUNC_1 = '03' ) |                                       */
   /*    ( S0CFUNC_1 = '21' ) |                                       */
   /*    ( S0CFUNC_1 = '99' & ^PART_ONLY ) THEN                       */
   /*    DO                                                           */
   /*      IF TEST_SW  THEN                                           */
   /*         DO                                                      */
   /*           DIAG_TEXT='AERULE2: BEFORE ^PO & SC NOT 44(PEND 08)'  */
   /*           CALL WRITE_TO_OPER                                    */
   /*         END                                                     */
   /*      FEDIT (S0IMACTC,                                           */
   /*             REQUIRED,                                           */
   /*             ALPHAN,                                             */
   /*             PEND,008)                                           */
   /*      IF TEST_SW  THEN                                           */
   /*        DO                                                       */
   /*          DIAG_TEXT ='AERULE2: AFTER ^PO & SC NOT 44(PEND 08)'   */
   /*          CALL WRITE_TO_OPER                                     */
   /*        END                                                      */
   /*    END                                                          */
     END;
   
   IF ( S0CSVC = '20' &
       (S0IMACTC = 'INST' | S0IMACTC = 'PROJ' | S0IMACTC = 'TASK') )
     THEN DO;
       ERR_SW = ON;
       FEDIT (ERR_SW,
              NOTALLOWED,
              BI,
              EQ,
              (ON),
              PEND,039)
        ERR_SW = OFF;
     END;
   

   IF ( ^MACHTYPE_BYPASS )
     THEN DO;
       IF GJIMMOD = ''         /* NO NEED TO VALIDATE WHEN NO MODEL   */
         THEN FAIL = '1'B;     /* PRESENT                             */
         ELSE FEDIT (M_MTM_REG,
                     REQUIRED,
                     ALPHAN,
                     EQ,
                     ('Y'),
                     WARNING,005)
       IF FAIL
         THEN
           FEDIT (M_MTM_SUPERLOW,
                  REQUIRED,
                  ALPHAN,
                  EQ,
                  ('Y'),
                  PEND,006)
     END;
  
   IF ( S0CFUNC_2 = '01' ) |
      ( S0CFUNC_2 = '02' ) |
      ( S0CFUNC_2 = '03' ) |
      ( S0CFUNC_2 = '21' ) |
      ( S0CFUNC_2 = '99' & ^PART_ONLY )
     THEN
        FEDIT (S0IMATL2_2,
               REQUIRED,
               ALPHANB,
               PEND,194)
   
   IF ( S0CFUNC_3 = '01' ) |
      ( S0CFUNC_3 = '02' ) |
      ( S0CFUNC_3 = '03' ) |
      ( S0CFUNC_3 = '21' ) |
      ( S0CFUNC_3 = '99' & ^PART_ONLY )
     THEN
        FEDIT (S0IMATL2_3,
               REQUIRED,
               ALPHANB,
               PEND,224)
   
   IF ( S0CFUNC_4 = '01' ) |
      ( S0CFUNC_4 = '02' ) |
      ( S0CFUNC_4 = '03' ) |
      ( S0CFUNC_4 = '21' ) |
      ( S0CFUNC_4 = '99' & ^PART_ONLY )
     THEN
        FEDIT (S0IMATL2_4,
               REQUIRED,
               ALPHANB,
               PEND,244)
   
                                       /* NOT ALLOWED                */
   IF CWA_COUNTRY_CODE = 'CA' & S0CSVC  = '48' & ^FACTADMN 
     THEN DO;
       ERR_SW = ON;
       FEDIT (ERR_SW,
              NOTALLOWED,
              BI,
              EQ,
              (ON),
              PEND,295)
       ERR_SW = OFF;
     END; 

 END MACHTYPE;

 %PAGE;
 MES_ECA:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  MES / ECA  (043, 041)                                           */
 /*  ( S0CMSCM )                                                     */
 /*  ----------------------                                          */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER
   THEN DO;
     IF S0CSVC = '33'
       THEN DO;
         FEDIT (S0CMOD,
                REQUIRED,
                ALPHAN,
                EQ,
                ('1'-'2'),
                PEND,043)                 /* MODIFICATIONS CODE      */
                                          /* S0CMOD  1 = MES NUMBER  */
         IF S0CMOD = '1'                  /*         2 = ECA NUMBER  */
           THEN DO;
             IF CGCMLCSP = 'Y'           /* MLC SHIP CONTROL         */
               THEN
                 FEDIT (S0CMSCM,
                        NOTALLOWED,
                        ALPHANB,
                        EQ,
                        (' '),
                       PEND,041)
               ELSE
                 FEDIT (S0CMSCM,
                        REQUIRED,
                        ALPHANB,
                        WARNING,041)
               IF FAIL
                 THEN S0CMSCM = '';
           END;
           ELSE
             IF S0CMOD = '2'
               THEN DO;
                 IF CGCMLCSP = 'Y'
                   THEN
                     FEDIT (S0CMSCM,
                            NOTALLOWED,
                            ALPHANB,
                            EQ,
                            (' '),
                            PEND,043)
                   ELSE
                     FEDIT (S0CMSCM,
                            REQUIRED,
                            ALPHANB,
                            WARNING,043)
                 IF FAIL
                   THEN S0CMSCM = '';
             END;
       END;
       ELSE DO;                     /* SC ^ = 33 */
         FEDIT (S0CMOD,
                REQUIRED,
                ALPHANB,
                EQ,
                (' '),
                WARNING,043)
         IF FAIL
           THEN S0CMOD = '';

         FEDIT (S0CMSCM,
                REQUIRED,
                ALPHANB,
                EQ,
                ('        '),
                WARNING,043)
         IF FAIL
           THEN S0CMSCM = '';
       END;
   END;

 END MES_ECA;

 %PAGE;
 METER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  METER READING (078, 079, 092)                                   */
 /*  ( S0QMETRE )                                                    */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
   IF TEST_SW
     THEN DO;
       DIAG_TEXT = 'AERULE2: meter mach? '||CGFMETER||
                                 ' meter '||S0QMETRE;
       CALL WRITE_TO_OPER;
     END;
     
 IF  ^PART_TRAILER  &
     ^PART_ONLY 
   THEN DO;
     IF CGFMETER = 'Y' 
       THEN DO;
         IF S0CSVC = '01'  |
            S0CSVC = '08'  |
            S0CSVC = '33' 
           THEN DO;
             FEDIT (S0QMETRE,
                    REQUIRED,
                    NUM,
                    WARNING,078)
             IF FAIL
               THEN S0QMETRE = '';
           END;
           ELSE
             IF S0CSVC = '20'  |
                S0CSVC = '36'  |
                S0CSVC = '47'  |
                S0CSVC = '48' 
               THEN DO;
                 FEDIT (S0QMETRE,
                        REQUIRED,
                        NUMB,
                        WARNING,078)
                 IF FAIL
                   THEN S0QMETRE = '';
                END;
                ELSE DO;
                  FEDIT (S0QMETRE,
                         REQUIRED,
                         ALPHANB,
                         EQ,
                         ('       '),
                         WARNING,079)
                  IF FAIL
                    THEN S0QMETRE = '';
                END;
              IF S0QUSAGE ^= '    '
                THEN
                  FEDIT (S0QMETRE,
                         REQUIRED,
                         NUM,
                         WARNING,092)
       END;    /* IF ( CGFMETER = 'Y' )  */
   END;    /* IF ( ^PART_TRAILER ) */

 END METER;

 %PAGE;
 JBILMETER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  METER READING (088, 089)                                        */
 /*  ( QJBILMTR )                                                    */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER  &
    ^PART_ONLY 
   THEN DO;

     IF ( S0IMACTC = '2709' | 
          S0IMACTC = '2710' | 
         (S0IMACTC = '4372'  &  S0IPECLV > '930' ) )
       THEN  DO;
         IF TEST_SW
           THEN DO;
             DIAG_TEXT = 'AERULE2: j-bill ('||QJBILMTR||')';
             CALL WRITE_TO_OPER;
           END;

         IF S0CSVC = '01'  |
            S0CSVC = '08'  |
            S0CSVC = '33'  
           THEN DO;
             FEDIT (QJBILMTR,
                    REQUIRED,
                    NUM,
                    PEND,088)
           END;
           ELSE IF S0CSVC = '20'  |
                   S0CSVC = '36'  |
                   S0CSVC = '47'  
                  THEN DO;
                    FEDIT (QJBILMTR,
                           REQUIRED,
                           NUM,
                           WARNING,088)
                    IF FAIL THEN
                      QJBILMTR = '';
                  END;

                  ELSE DO;
                    FEDIT (QJBILMTR,
                           REQUIRED,
                           ALPHANB,
                           EQ,
                           ('       '),
                           WARNING,089)
                    IF FAIL
                      THEN QJBILMTR = '';
                  END;
       END;
       ELSE DO;
         FEDIT (QJBILMTR,
                REQUIRED,
                ALPHANB,
                EQ,
                ('       '),
                WARNING,089)
         IF FAIL
           THEN QJBILMTR = '';
       END;


   END;    /* IF ^PART_TRAILER  */

 END JBILMETER;


 %PAGE;
 MILEAGE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  MILEAGE (060)                                                   */
 /*  ( S0QTRAMI )                                                    */
 /*  --------------------                                            */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
   FEDIT (S0QTRAMI,
          REQUIRED,
          NUMB,
          WARNING,060)
   IF FAIL
     THEN S0QTRAMI = '';

 END MILEAGE;

 %PAGE;
 MODS_NA_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  MODIFICATIONS N/A CODE (034)                                    */
 /*  ( S0CMODNA )                                                    */
 /*  -----------------------------------                             */
 /*  THIS FIELD IS KNOWN IN PT-LINGO AS "PREINST/NOTHER/CNL"         */
 /*  -----------------------------------                             */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

   FEDIT (S0CMODNA,
          REQUIRED,
          NUMB,
          WARNING,034)
   IF FAIL
     THEN S0CMODNA = '';
     
 END MODS_NA_CODE;

 %PAGE;
 OVERTIME:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  OVERTIME HOURS (053, 055)                                       */
 /*   ( S0QOVTHR ) (Alphanumeric)                                    */
 /*   --------------------------                                     */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 IF PART_TRAILER               /* PART TRAILERS SHOULD NEVER HAVE OT */
   THEN DO;
     FEDIT (S0QOVTHR,
            REQUIRED,
            ALPHANB,
            EQ,
            ('   ','000'),
           WARNING,053)
     IF FAIL THEN S0QOVTHR = '000';     /* ERASE OT ON PART TRAILERS */
   END;
   ELSE DO;                 /* IF NOT A PART TRAILER, VALIDITY CHECK */
                            /* MUST BE NUMERIC OR BLANK              */
     FEDIT (S0QOVTHR,
            REQUIRED,
            NUMB,
            WARNING,053)
     IF FAIL THEN S0QOVTHR = '000';        /* ERASE NON-NUMERIC DATA */
   END;

 IF ^PART_ONLY & ^PART_TRAILER & M_FEDF = 'Y' 
   THEN DO;                            /* BEGIN GENERAL HOURS AUDITS */

                                   /* COPY CHAR DATA INTO PIC FIELDS */
     S0QTRAHR_TEMP = S0QTRAHR_NUM; /* TRAVEL HOURS    (HHT)          */
     S0QOVTHR_TEMP = S0QOVTHR_NUM; /* OVERTIME HOURS  (HHT)          */
     S0QSVCHR_TEMP = S0QSVCHR_NUM; /* ACTUAL HOURS    (HHT)          */

     IF S0QTRAHR_TEMP < 0
       THEN S0QTRAHR_TEMP = 0;

     IF S0QSVCHR_TEMP < 0
       THEN S0QSVCHR_TEMP = 0;

     IF S0QOVTHR_TEMP < 0
       THEN S0QOVTHR_TEMP = 0;

     NON_OT_HRS = S0QSVCHR_TEMP + S0QTRAHR_TEMP - S0QOVTHR_TEMP;

            /*******************************************/
            /* 1. IF NON_OT_HRS < 0, THERE IS AN ERROR */
            /*******************************************/

     IF NON_OT_HRS < 0                            /* OT IS EXCESSIVE */
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,055)
          ERR_SW = OFF;
       END;
       ELSE;
   END;
   ELSE;                             /* NO CHECKS FOR SERVICE CODE 94 */

 END OVERTIME;

 %PAGE;
 PRODID:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PRODUCT ID       (296, 297)                                     */
 /*  (S0IPRDID)                                                      */
 /*  ---------------------------                                     */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

     IF S0IPRDID > '' 
       THEN FEDIT (M_PRODID,
                   REQUIRED,
                   ALPHAN,
                   EQ,
                   ('Y'),
                   PEND,296)                  /* ENTERED BUT INVALID */

 END PRODID;

 %PAGE;
 OTHER_OFFICE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  OTHER OFFICE WORKED (064, 063, 069, 070, 065, 066)              */
 /*  ( S0IOTBCW )                                                    */
 /*  --------------------------------                                */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER  &        /* PART ONLY AND PART TRAILER DO NOT  */
    ^PART_ONLY              /* PROMPT FOR OTHER B/O IN THE PT     */
   THEN DO;                 /* CHECK FOR BAD CHARACTERS */
     FEDIT (S0IOTBCW,
            REQUIRED,
            ALPHANB,
            PEND,064)

     ERR_SW = OFF;
     IF S0CSVC = '47'                    /* SERVICE CODE             */
       THEN DO;
         IF S0IMACSE = ' ' 
           THEN FEDIT (S0IOTBCW,
                       REQUIRED,
                       ALPHAN,
                       PEND,064)

                           /* CHECK TO SEE IF IT'S MKBO */
       IF S0IOTBCW ^= ' '   &  M_OTHOFF_M = 'N'   &
          S0IOTBCW ^= '071' &  S0IOTBCW  ^= '073' &
          S0IOTBCW ^= '090' &  S0IOTBCW  ^= '093' &
          S0IOTBCW ^= '095' &  S0IOTBCW  ^= '104' &
          S0IOTBCW ^= '110' &  S0IOTBCW  ^= '115' &
          S0IOTBCW ^= '117' &  S0IOTBCW  ^= '125' &
          S0IOTBCW ^= '128' &  S0IOTBCW  ^= '230'
          THEN DO;

           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,069)           /* OTBO IS NOT A MKBO    */
            ERR_SW = OFF;
         END;

       IF S0IOTBCW  = ' '   &          /* OTHER SR B/O WORKED   */
          S0IMACSE ^= ' '   &          /* MACHINE SERIAL        */
         (CMIBOMKT  = '   ' |          /* MARKETING B/O         */
          CMIBOMKT  = '000' |          /* MARKETING B/O         */
          CMIBOMKT  = '996' )          /* MARKETING B/O         */
         THEN DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,070)
            ERR_SW = OFF;
         END;
     END;                              /* IF SERVICE CODE 47         */

     IF S0CSVC = '65'                  /* SERVICE CODE               */
       THEN DO;
         FEDIT (S0IOTBCW,
                REQUIRED,
                ALPHANB,
                EQ,
                ('   '),
                WARNING,065)
         IF FAIL 
           THEN S0IOTBCW = '';             /* OTHER SR B/O WORKED    */
       END;

     IF S0IOTBCW ^= '   '  &               /* OTHER SR B/O WORKED    */
        M_OTHOFF_S = 'N'   &               /* BOREF SERVICE OFFICE   */
        S0CSVC ^= '47'                     /* SERVICE CODE           */
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,064)
          ERR_SW = OFF;
       END;

     IF S0IOTBCW ^= '   ' &                 /* OTHER SR B/O WORKED   */
        S0CSVC   ^= '47'  &                 /* SERVICE CODE          */
        BRFUNC   ^= 'H'   &                 /* BOREF FUNCTION CODE   */
        BRFUNC   ^= '1'   &                 /* BOREF FUNCTION CODE   */
        BRFUNC   ^= '2'                     /* BOREF FUNCTION CODE   */
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                WARNING,066)
          ERR_SW = OFF;
       END;
   END;   /* IF ^PART_TRAILER  */

 END OTHER_OFFICE;

 
 %PAGE;
 PART_NUMBER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PART NUMBER (151, 152, 163, 181, 182, 193, 211, 212, 223, 231,  */
 /*              (232, 243)                                          */
 /*  ( S0IPART(4) )                                                  */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF S0CFUNC_1 > ' '  
   THEN DO;
     FEDIT (OEMPART_1,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,151)      /* OEM PART NUMBER IS MISSING OR INVALID */

     IF CPRTORGN_1 ^= 'T'
       THEN DO;
         FEDIT (OEMFLAG_1,
                REQUIRED,
                ALPHAN,
                NE,
                ('B'),
                PEND,152)  /* OEM/IBM PART NUMBER IS NOT ON FILE     */

         FEDIT (OEMFLAG_1,
                REQUIRED,
                ALPHAN,
                NE,
                ('P'),
                PEND,163)  /* SECOND PCREF LOOKUP FAILED             */
       END;
   END;
 ELSE;

 IF S0CFUNC_2 > ' ' 
   THEN DO;
     FEDIT (OEMPART_2,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,181)      /* OEM PART NUMBER IS MISSING OR INVALID */

     IF CPRTORGN_2 ^= 'T'
       THEN DO;
         FEDIT (OEMFLAG_2,
                REQUIRED,
                ALPHAN,
                NE,
                ('B'),
                PEND,182)  /* OEM/IBM PART NUMBER IS NOT ON FILE     */

         FEDIT (OEMFLAG_2,
                REQUIRED,
                ALPHAN,
                NE,
                ('P'),
                PEND,193) /* SECOND PCREF LOOKUP FAILED             */
       END;
   END;
 ELSE;

 IF S0CFUNC_3 > ' ' 
   THEN DO;
     FEDIT (OEMPART_3,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,211)       /* OEM PART NUMBER IS MISSING OR INVALID */

     IF CPRTORGN_3 ^= 'T'
       THEN DO;
         FEDIT (OEMFLAG_3,
                REQUIRED,
                ALPHAN,
                NE,
                ('B'),
                PEND,212)  /* OEM/IBM PART NUMBER IS NOT ON FILE     */

         FEDIT (OEMFLAG_3,
                REQUIRED,
                ALPHAN,
                NE,
                ('P'),
                PEND,223)  /* SECOND PCREF LOOKUP FAILED             */
       END;
   END;
 ELSE;

 IF S0CFUNC_4 > ' ' 
   THEN DO;
     FEDIT (OEMPART_4,
            REQUIRED,
            ALPHANB,
            GT,
            (' '),
            PEND,231)       /* OEM PART NUMBER IS MISSING OR INVALID */

     IF CPRTORGN_4 ^= 'T'
       THEN DO;
         FEDIT (OEMFLAG_4,
                REQUIRED,
                ALPHAN,
                NE,
                ('B'),
                PEND,232)  /* OEM/IBM PART NUMBER IS NOT ON FILE     */

         FEDIT (OEMFLAG_4,
                REQUIRED,
                ALPHAN,
                NE,
                ('P'),
                PEND,243)  /* SECOND PCREF LOOKUP FAILED             */
       END;
   END;
 ELSE;

 %PAGE;
 /********************************************************************/
 /*                                                                  */
 /*  HDA PART NUMBER EDITS (120)                                     */
 /*  ( S0IPART(1-4) )                                                */
 /*  --------------------------------------                          */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*  THIS NEEDS TO BE REMOVED WHEN TABLE 8.3.0 EXPIRES               */
 /********************************************************************/

    FEDIT (PEND_HDA,
           REQUIRED,
           ALPHAN,
           EQ,
           ('N'),
           PEND,120)

 END PART_NUMBER;

 %PAGE;
 PM_FREQ:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PM FREQUENCY (036, 037)                                         */
 /*  ( S0IPMFSA )                                                    */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER 
   THEN DO;
     IF S0CSVC = '08'
       THEN DO;
         IF M_PMSCHED ^= 'N' 
           THEN FEDIT (S0IPMFSA,
                       REQUIRED,
                       NUMB,
                       EQ,
                       ('','01','02','03','04','05','06',
                           '07','08','09','10','11','12',
                           '13','14','15','16','17','18','99'),
                       PEND,036)
           ELSE DO;    /* IF PM SCHEDULE IS NOT FOUND ON MTM */
             FEDIT (S0IPMFSA,
                    REQUIRED,
                    NUMB,
                    EQ,
                    ('  '),
                    WARNING,037)
             IF FAIL THEN
               S0IPMFSA = '';
           END;
       END;
     ELSE                                   /* IF ( S0CSVC ^= '08' ) */
       S0IPMFSA = '';
   END;                                      /* IF ( ^PART_TRAILER ) */

 END PM_FREQ;

 %PAGE;
 PRF_NUMBER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PRF NUMBER (320, 321, 322, 323)                                 */
 /*  (IPRFNUM (4) )                                                  */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /* prf required when the part is a red tag or UPR part              */
 /*                                                                  */
 /********************************************************************/
 
   IF TEST_SW
     THEN DO;
       DIAG_TEXT = 'AERULE2: usage qty '||S0QDISUS_1||' USA? '||
                     USA ||' FC '||S0CFUNC_1||' RED? '||
                     CGPART1T(1)|| ' PRF req? '|| PRF_REQ(1);
       CALL WRITE_TO_OPER;
     END;
   IF PRF_REQ(1) = 'Y' & USA
     THEN DO;
       FEDIT (IPRFNUM(1),
              REQUIRED,
              ALPHAN,
              PEND,320)
       /* check usage quantity to equal to 1 when you have a PRF  */
       IF ( S0CFUNC_1 = '02'  |  S0CFUNC_1 = '21' ) 
                               &
            IPRFNUM(1) ^= ''   & 
            IPRFNUM(1) ^= '0000000'
         THEN
           FEDIT (S0QDISUS_1,
                 REQUIRED,
                 NUM,
                 EQ,
                 ('01'),
                 PEND,160)
       /* check return quantity to equal to 1 when you have a PRF */
       /* and function code 99 - defective part return            */
       IF ( S0CFUNC_1 = '04' | S0CFUNC_1 = '99' ) &
          IPRFNUM(1) ^= ''   & 
          IPRFNUM(1) ^= '0000000'
         THEN
           FEDIT (S0QREPOR_1,
                 REQUIRED,
                 NUM,
                 EQ,
                 ('01'),
                 PEND,162)
   
     END;
     
   IF PRF_REQ(2) = 'Y' & USA
     THEN DO;
       FEDIT (IPRFNUM(2),
              REQUIRED,
              ALPHAN,
              PEND,321)
       /* check usage quantity to equal to 1 when you have a PRF */
       IF ( S0CFUNC_2 = '02' | S0CFUNC_2 = '21' ) 
                               &
            IPRFNUM(2) ^= ''   & 
            IPRFNUM(2) ^= '0000000'
         THEN
           FEDIT (S0QDISUS_2,
                 REQUIRED,
                 NUM,
                 EQ,
                 ('01'),
                 PEND,190)
                 
       /* check return quantity to equal to 1 when you have a PRF */
       /* and function code 99 - defective part return            */
       IF ( S0CFUNC_2 = '04' | S0CFUNC_2 = '99' ) &
          IPRFNUM(2) ^= ''   & 
          IPRFNUM(2) ^= '0000000'
         THEN
           FEDIT (S0QREPOR_2,
                 REQUIRED,
                 NUM,
                 EQ,
                 ('01'),
                 PEND,192)
                 
     END;
   
   IF PRF_REQ(3) = 'Y' & USA
     THEN DO;
       FEDIT (IPRFNUM(3),
              REQUIRED,
              ALPHAN,
              PEND,322)
       /* check usage quantity to equal to 1 when you have a PRF  */
       IF ( S0CFUNC_3 = '02' | S0CFUNC_3 = '21' )
                              &
            IPRFNUM(3) ^= ''  & 
            IPRFNUM(3) ^= '0000000'
         THEN
           FEDIT (S0QDISUS_3,
                 REQUIRED,
                 NUM,
                 EQ,
                 ('01'),
                 PEND,220)
       /* check return quantity to equal to 1 when you have a PRF */
       /* and function code 99 - defective part return            */
       IF ( S0CFUNC_3 = '04' | S0CFUNC_3 = '99' )   &
          IPRFNUM(3) ^= ''   & 
          IPRFNUM(3) ^= '0000000'
         THEN FEDIT (S0QREPOR_3,
                     REQUIRED, 
                     NUM,
                     EQ,
                     ('01'),
                     PEND,222)
   
     END;
   
   IF PRF_REQ(4) = 'Y' & USA
     THEN DO;
       FEDIT (IPRFNUM(4),
              REQUIRED,
              ALPHAN,
              PEND,323)
       /* check usage quantity to equal to 1 when you have a PRF  */
       IF ( S0CFUNC_4 = '02' | S0CFUNC_4 = '21' )
                          &
            IPRFNUM(4) ^= '' & 
            IPRFNUM(4) ^= '0000000'
         THEN FEDIT (S0QDISUS_4,
                     REQUIRED,
                     NUM,
                     EQ,
                     ('01'),
                     PEND,240)
                 
       /* check return quantity to equal to 1 when you have a PRF */
       /* and function code 99 - defective part return            */
       IF ( S0CFUNC_4 = '04' | S0CFUNC_4 = '99' ) &
          IPRFNUM(4) ^= ''   & 
          IPRFNUM(4) ^= '0000000'
         THEN
           FEDIT (S0QREPOR_4,
                 REQUIRED,
                 NUM,
                 EQ,
                 ('01'),
                 PEND,242)
   
     END;
   
   

 END PRF_NUMBER;

 %PAGE;
 PROBLEM_NUMBER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PROBLEM NUMBER (076, 077, 277)                                  */
 /*  ( S0CCSCPC )                                                    */
 /*  ----------------------------                                    */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF S0CSVC = '01'
   THEN FEDIT (PROB_CHAR7,
               REQUIRED,
               ALPHAN,
               PEND,076)
 /* ELSE
     IF  FSRCDART & (S0CSVC^= '55' & S0CSVC ^= '65') THEN
     FEDIT (PROB_CHAR7,                    removed 5NSM
            REQUIRED,
            ALPHAN,
            PEND,076)
     ELSE
     IF ( S0CSVC = '94' ) & (SUBSTR(S0CHACT,2,1) = '1') THEN
       FEDIT (PROB_CHAR5,
              REQUIRED,                    5NSM
              ALPHAN,
              PEND,277)                     */
     ELSE 
     /* --------------------------------------------------------*/
     /*  IF A PART IS PRESENT AND THE FUNCTION USED TO ENTER    */
     /*  THE RECORD IS 'IR' OR 'PT' THEN A PROBLEM NUMBER IS    */
     /*  REQUIRED, ELSE PEND ERROR 277 WILL RESULT              */
     /*                                                         */
     /*  IF THE FUNCTION USED TO ENTER THE RECORD IS 'PO' AND   */
     /*  THE FROM OUTSIDE LOCATION IS >= '500' THEN A PROBLEM   */
     /*  NUMBER IS REQUIRED, ELSE PEND ERROR 277 WILL RESULT.   */
     /* --------------------------------------------------------*/
       IF ( (OEMPART_1 ^= ' ' | OEMPART_2 ^= ' '   |
             OEMPART_3 ^= ' ' | OEMPART_4 ^= ' ')  &
             (CS1CFUNC = 'IR' | CS1CFUNC = 'PT'   |
             (CS1CFUNC = 'PO' &
                       (S0CFUNC_1 = '01' |S0CFUNC_1 = '03'|
                        S0CFUNC_2 = '01' |S0CFUNC_2 = '03'|
                        S0CFUNC_3 = '01' |S0CFUNC_3 = '03'|
                        S0CFUNC_4 = '01' |S0CFUNC_4 = '03') &
                           S0ISENOL >= '500')) )  
           THEN  FEDIT (PROB_CHAR7,
                 REQUIRED,
                 ALPHAN,
                 PEND,277)
   ELSE
     IF  S0CSVC = '48'  |
         S0CSVC = '55'  |
         S0CSVC = '65' 
       THEN DO;
         FEDIT (PROB_CHAR7,
                REQUIRED,
                ALPHANB,
                EQ,
                ('     '),
                WARNING,077)

       END;

 END PROBLEM_NUMBER;

 %PAGE;
 PT_ASSIGNED_BO:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  PT-ASSIGNED BRANCH (024, 025)                                   */
 /*  ( S0IBOEMP )                                                    */
 /*  --------------------------------                                */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF M_PTBO_BOREF = 'N' & ^FSRCNSS & ISOURCE = ''
   THEN DO;
     IF S0ISRCPT                 /* IF FROM PT, THEN EXPECT S0IBOEMP */
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                WARNING,024)
          ERR_SW = OFF;
       END;
     S0IBOEMP = '999';
   END;

 IF BRFUNC ^= '1'  &                    /* BOREF FUNCTION CODE       */
    BRFUNC ^= '2'  &                    /* BOREF FUNCTION CODE       */
    BRFUNC ^= '9'  &                    /* BOREF FUNCTION CODE       */
    S0ISRCPT 
   THEN DO;
     ERR_SW = ON;
     FEDIT (ERR_SW,
            NOTALLOWED,
            BI,
            EQ,
            (ON),
            WARNING,025)
     S0IBOEMP = '999';
     ERR_SW = OFF;
   END;

 END PT_ASSIGNED_BO;

 %PAGE;
 QSAR_TYPE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  TYPE OF QSAR -  (099)                                           */
 /*   I = INCIDENT, P = PARTS, B = BOTH                              */
 /*  ----------------------------------                              */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

   FEDIT (CHCDATIT,
          REQUIRED,
          ALPHAN,
          EQ,
          ('I','B','P'),
          PEND,099)
        
 END QSAR_TYPE;

 %PAGE;
 REC_BO:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  RECEIVING BRANCH (155, 157, 183, 185, 187, 213, 215, 217, 235   */
 /*                    237)                                          */
 /*  ( S0IRECBO(4) )                                                 */
 /*  ---------------------------------                               */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 /* PART LINE 1   */
 IF (S0CFUNC_1 = '01'  |
     S0CFUNC_1 = '02'  |
     S0CFUNC_1 = '09'  |
     S0CFUNC_1 = '10'  |
     S0CFUNC_1 = '21'   ) & FPARTVAL
    THEN DO;
      FEDIT (S0IRECBO_1,
             REQUIRED,
             ALPHAN,
             PEND,153)
      IF M_RCVBO_1 = 'N'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,155)
           ERR_SW = OFF;
        END;
   END;
   ELSE
     IF S0CFUNC_1 = '03'  |
        S0CFUNC_1 = '04'  |
        S0CFUNC_1 = '99' 
       THEN FEDIT (S0IRECBO_1,
                   REQUIRED,
                   ALPHANB,
                   EQ,
                   ('   '),
                   PEND,157)

 /* PART LINE 2   */
 IF ( S0CFUNC_2 = '01'  |
      S0CFUNC_2 = '02'  |
      S0CFUNC_2 = '09'  |
      S0CFUNC_2 = '10'  |
      S0CFUNC_2 = '21'   ) & FPARTVAL
   THEN DO;
     FEDIT (S0IRECBO_2,
            REQUIRED,
            ALPHAN,
            PEND,183)
     IF M_RCVBO_2 = 'N' 
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,185)
          ERR_SW = OFF;
       END;
   END;
   ELSE
     IF S0CFUNC_2 = '03'  |
        S0CFUNC_2 = '04'  |
        S0CFUNC_2 = '99' 
       THEN
         FEDIT (S0IRECBO_2,
                REQUIRED,
                ALPHANB,
                EQ,
                ('   '),
                PEND,187)

 /* PART LINE 3   */
 IF ( S0CFUNC_3 = '01'  |
      S0CFUNC_3 = '02'  |
      S0CFUNC_3 = '09'  |
      S0CFUNC_3 = '10'  |
      S0CFUNC_3 = '21'   ) & FPARTVAL
    THEN DO;
      FEDIT (S0IRECBO_3,
             REQUIRED,
             ALPHAN,
             PEND,213)
      IF M_RCVBO_3 = 'N'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,215)
          ERR_SW = OFF;
        END;
    END;
    ELSE
      IF S0CFUNC_3 = '03'  |
         S0CFUNC_3 = '04'  |
         S0CFUNC_3 = '99' 
        THEN
          FEDIT (S0IRECBO_3,
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 ('   '),
                 PEND,217)

 /* PART LINE 4   */
 IF ( S0CFUNC_4 = '01'  |
      S0CFUNC_4 = '02'  |
      S0CFUNC_4 = '09'  |
      S0CFUNC_4 = '10'  |
      S0CFUNC_4 = '21'   ) & FPARTVAL
   THEN DO;
     FEDIT (S0IRECBO_4,
            REQUIRED,
            ALPHAN,
            PEND,233)
     IF  M_RCVBO_4 = 'N'
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,235)
         ERR_SW = OFF;
       END;
   END;
   ELSE
     IF S0CFUNC_4 = '03'  |
        S0CFUNC_4 = '04'  |
        S0CFUNC_4 = '99' 
       THEN FEDIT (S0IRECBO_4,
                   REQUIRED,
                   ALPHANB,
                   EQ,
                   ('   '),
                   PEND,237)


 END REC_BO;

 %PAGE;
 REC_OL:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  RECEIVING OUTSIDE LOCATION (154, 156, 158, 184, 186, 188, 214,  */
 /*                              216, 234, 238, 172, 197, 229, 247   */
 /*  ( S0IRECOL(4) )                                                 */
 /*  -------------------------------------------                     */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ( S0CFUNC_1 = '01'  |
      S0CFUNC_1 = '02'  |
      S0CFUNC_1 = '09'  |
      S0CFUNC_1 = '10'  |
      S0CFUNC_1 = '21'   ) & FPARTVAL
   THEN DO;
     FEDIT (S0IRECOL_1,
            REQUIRED,
            NUM,
            PEND,154)

     IF S0CFUNC_1 = '02'  |
        S0CFUNC_1 = '21' 
       THEN FEDIT (S0IRECOL_1,
                   REQUIRED,
                   NUM,
                   EQ,
                   ('500'-'999'),
                   PEND,171)

     IF M_RCVOL_1 = 'N'
       THEN DO;
         ERR_SW = ON;
         FEDIT (ERR_SW,
                NOTALLOWED,
                BI,
                EQ,
                (ON),
                PEND,156)
         ERR_SW = OFF;
       END;
   END;
   ELSE
     IF ( S0CFUNC_1 = '03' ) |
        ( S0CFUNC_1 = '04' ) |
        ( S0CFUNC_1 = '99' )
        THEN
          FEDIT (S0IRECOL_1,
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 ('   '),
                 PEND,158)

                                 /*---------------------------------*/
                                 /* IF COLINVALID FLAG SET FOR      */
                                 /* PART LINE AND FC = '01' OR      */
                                 /* AND REC OL < '500' THEN WE      */
                                 /* NEED TO PEND WITH A 251         */
                                 /* ------S9600489                  */
                                 /*---------------------------------*/

 /* --------------------------------------------------------------- */
 /*IF (S0CFUNC_1 = '01' & FOLINVAL_1 = 'Y' & S0IRECOL_1 < '500')THEN*/
 /*  DO                                                             */
 /*       ERR_SW = ON                                               */
 /*       FEDIT (ERR_SW,                     valid range for fc 01  */
 /*              NOTALLOWED,                 is 001-999             */
 /*              BI,                                                */
 /*              EQ,                                                */
 /*              (ON),                                              */
 /*              PEND,171)                                          */
 /*       ERR_SW = OFF                                              */
 /*  END                                                            */
 /* --------------------------------------------------------------- */

 IF ( S0CFUNC_2 = '01'  |
      S0CFUNC_2 = '02'  |
      S0CFUNC_2 = '09'  |
      S0CFUNC_2 = '10'  |
      S0CFUNC_2 = '21'    ) & FPARTVAL
    THEN DO;
      FEDIT (S0IRECOL_2,
             REQUIRED,
             NUM,
             PEND,184)

      IF S0CFUNC_2 = '02'  |
         S0CFUNC_2 = '21' 
         THEN
           FEDIT (S0IRECOL_2,
                  REQUIRED,
                  NUM,
                  EQ,
                  ('500'-'999'),
                  PEND,195)

      IF M_RCVOL_2 = 'N'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,186)
           ERR_SW = OFF;
        END;
   END;
   ELSE
    IF S0CFUNC_2 = '03'  |
       S0CFUNC_2 = '04'  |
       S0CFUNC_2 = '99' 
      THEN FEDIT (S0IRECOL_2,
                  REQUIRED,
                  ALPHANB,
                  EQ,
                  ('   '),
                  PEND,188)

                                 /*---------------------------------*/
                                 /* IF COLINVALID FLAG SET FOR      */
                                 /* PART LINE AND FC = '01' OR      */
                                 /* AND REC OL < '500' THEN WE      */
                                 /* NEED TO PEND WITH A 251         */
                                 /* ------S9600489                  */
                                 /*---------------------------------*/
 /* --------------------------------------------------------------- */
 /*IF (S0CFUNC_2 = '01' & FOLINVAL_2 = 'Y' & S0IRECOL_2 < '500')THEN*/
 /*  DO                                                             */
 /*       ERR_SW = ON                                               */
 /*       FEDIT (ERR_SW,                                            */
 /*              NOTALLOWED,                                        */
 /*              BI,                                                */
 /*              EQ,                                                */
 /*              (ON),                                              */
 /*              PEND,195)                                          */
 /*       ERR_SW = OFF                                              */
 /*  END                                                            */
 /* --------------------------------------------------------------- */

 IF ( S0CFUNC_3 = '01'  |
      S0CFUNC_3 = '02'  |
      S0CFUNC_3 = '09'  |
      S0CFUNC_3 = '10'  |
      S0CFUNC_3 = '21'   ) & FPARTVAL
    THEN DO;
      FEDIT (S0IRECOL_3,
             REQUIRED,
             NUM,
             PEND,214)

      IF S0CFUNC_3 = '02'  |
         S0CFUNC_3 = '21' 
         THEN FEDIT (S0IRECOL_3,
                     REQUIRED,
                     NUM,
                     EQ,
                     ('500'-'999'),
                     PEND,227)

      IF M_RCVOL_3 = 'N' 
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,216)
          ERR_SW = OFF;
        END;

   END;
   ELSE
     IF S0CFUNC_3 = '03'  |
        S0CFUNC_3 = '04'  |
        S0CFUNC_3 = '99' 
       THEN FEDIT (S0IRECOL_3,
                   REQUIRED,
                   ALPHANB,
                   EQ,
                   ('   '),
                   PEND,218)

                                 /*---------------------------------*/
                                 /* IF COLINVALID FLAG SET FOR      */
                                 /* PART LINE AND FC = '01' OR      */
                                 /* AND REC OL < '500' THEN WE      */
                                 /* NEED TO PEND WITH A 251         */
                                 /* ------S9600489                  */
                                 /*---------------------------------*/
 /* --------------------------------------------------------------- */
 /*IF (S0CFUNC_3 = '01' & FOLINVAL_3 = 'Y' & S0IRECOL_3 < '500')THEN*/
 /*  DO                                                             */
 /*    ERR_SW = ON                                                  */
 /*    FEDIT (ERR_SW,                                               */
 /*           NOTALLOWED,                                           */
 /*           BI,                                                   */
 /*           EQ,                                                   */
 /*           (ON),                                                 */
 /*           PEND,227)                                             */
 /*    ERR_SW = OFF                                                 */
 /*  END                                                            */
 /* --------------------------------------------------------------- */

 IF ( S0CFUNC_4 = '01'  |
      S0CFUNC_4 = '02'  |
      S0CFUNC_4 = '09'  |
      S0CFUNC_4 = '10'  |
      S0CFUNC_4 = '21'    ) & FPARTVAL
    THEN DO;
      FEDIT (S0IRECOL_4,
             REQUIRED,
             NUM,
             PEND,234)

      IF S0CFUNC_4 = '02'  |
         S0CFUNC_4 = '21'
        THEN FEDIT (S0IRECOL_4,
                    REQUIRED,
                    NUM,
                    EQ,
                    ('500'-'999'),
                    PEND,245)

       IF M_RCVOL_4 = 'N' 
         THEN DO;
           ERR_SW = ON;
           FEDIT (ERR_SW,
                  NOTALLOWED,
                  BI,
                  EQ,
                  (ON),
                  PEND,236)
           ERR_SW = OFF;
         END;

    END;
    ELSE
      IF S0CFUNC_4 = '03'  |
         S0CFUNC_4 = '04'  |
         S0CFUNC_4 = '99' 
        THEN FEDIT (S0IRECOL_4,
                    REQUIRED,
                    ALPHANB,
                    EQ,
                    ('   '),
                    PEND,238)

                                 /*---------------------------------*/
                                 /* IF COLINVALID FLAG SET FOR      */
                                 /* PART LINE AND FC = '01' OR      */
                                 /* AND REC OL < '500' THEN WE      */
                                 /* NEED TO PEND WITH A 251         */
                                 /* ------S9600489                  */
                                 /*---------------------------------*/
 /* --------------------------------------------------------------- */
 /*IF (S0CFUNC_4 = '01' & FOLINVAL_4 = 'Y' & S0IRECOL_4 < '500')THEN*/
 /*  DO                                                             */
 /*       ERR_SW = ON                                               */
 /*       FEDIT (ERR_SW,                                            */
 /*              NOTALLOWED,                                        */
 /*              BI,                                                */
 /*              EQ,                                                */
 /*              (ON),                                              */
 /*              PEND,245)                                          */
 /*       ERR_SW = OFF                                              */
 /*  END                                                            */
 /* --------------------------------------------------------------- */

 END REC_OL;

 %PAGE;
 REP_PART_QTY:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  REP PART QUANTITY (162, 161, 168, 192, 191, 198, 222, 221, 228, */
 /*                     242, 241, 248)                               */
 /*  ( S0QREPOR(4) )                                                 */
 /*  ----------------------------------                              */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 IF TEST_SW
   THEN DO;
     DIAG_TEXT = 'AERULE2: return qty '||S0QREPOR_1||' USA? '||
                   USA ||' FC '||S0CFUNC_1||' RED? '||
                   CGPART1T(1);
     CALL WRITE_TO_OPER;
   END;

 /* PROCESS PART LINE 1 */

 IF S0CFUNC_1 = '01' |
    S0CFUNC_1 = '21' 
    THEN DO;
      FEDIT (S0QREPOR_1,
             REQUIRED,
             NUMB,
             PEND,162)

      IF S0CFUNC_1 = '01' & S0ISENOL > '496' & S0QREPOR_1 > '00'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,162)
          ERR_SW = OFF;
        END;
    END;
 ELSE
   IF S0CFUNC_1 = '99' 
     THEN FEDIT (S0QREPOR_1,
            REQUIRED,
            NUM,
            GT,
            ('00'),
            PEND,162)
     ELSE
     IF S0CFUNC_1 = '03'    |
        S0CFUNC_1 = '04' 
       THEN FEDIT (S0QREPOR_1,
                   REQUIRED,
                   NUM,
                   GT,
                   ('00'),
                   PEND,161)
       ELSE
       IF S0CFUNC_1 = '02' |
          S0CFUNC_1 = '06'
         THEN DO;
           FEDIT (S0QREPOR_1,
                  REQUIRED,
                  ALPHANB,
                  EQ,
                  ('  '),
                  WARNING,168)
           IF FAIL
             THEN S0QREPOR_1 = '';
         END;

 /* IF ( S0CFUNC_1 = '04' | S0CFUNC_1 = '99' ) &
      CGPART1T(1) = 'R'  &   
      USA
   THEN
     FEDIT (S0QREPOR_1,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,351)    */
     
 /* PROCESS PART LINE 2 */

 IF S0CFUNC_2 = '01' |
    S0CFUNC_2 = '21'
    THEN DO;
      FEDIT (S0QREPOR_2,
             REQUIRED,
             NUMB,
             PEND,192)

      IF S0CFUNC_2 = '01' & S0ISENOL > '496' & S0QREPOR_2 > '00'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,192)
          ERR_SW = OFF;
        END;
    END;
    ELSE
      IF S0CFUNC_2 = '99' 
        THEN FEDIT (S0QREPOR_2,
                    REQUIRED,
                    NUM,
                    GT,
                    ('00'),
                    PEND,192)
        ELSE
        IF S0CFUNC_2 = '03'   |
           S0CFUNC_2 = '04'
          THEN FEDIT (S0QREPOR_2,
                 REQUIRED,
                 NUM,
                 GT,
                 ('00'),
                 PEND,191)
        ELSE
          IF S0CFUNC_2 = '02' |
             S0CFUNC_2 = '06' 
            THEN DO;
              FEDIT (S0QREPOR_2,
                     REQUIRED,
                     ALPHANB,
                     EQ,
                     ('  '),
                     WARNING,198)
              IF FAIL
                THEN S0QREPOR_2 = '';
            END;

 /*IF ( S0CFUNC_2 = '04' | S0CFUNC_2 = '99' ) &
      CGPART1T(2) = 'R'  &    
      USA
   THEN
     FEDIT (S0QREPOR_2,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,352)  */
     
 /* PROCESS PART LINE 3 */

 IF S0CFUNC_3 = '01'  |
    S0CFUNC_3 = '21' 
    THEN DO;
      FEDIT (S0QREPOR_3,
             REQUIRED,
             NUMB,
             PEND,222)

      IF S0CFUNC_3 = '01' & S0ISENOL > '496' & S0QREPOR_3 > '00'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,2222)
          ERR_SW = OFF;
        END;
    END;
   ELSE
     IF S0CFUNC_3 = '99' 
       THEN FEDIT (S0QREPOR_3,
                   REQUIRED,
                   NUM,
                   GT,
                   ('00'),
                   PEND,222)
     ELSE
       IF S0CFUNC_3 = '03'  |
          S0CFUNC_3 = '04'
         THEN FEDIT (S0QREPOR_3,
                     REQUIRED,
                     NUM,
                     GT,
                     ('00'),
                     PEND,221)
         ELSE
         IF S0CFUNC_3 = '02'  |
            S0CFUNC_3 = '06' 
           THEN DO;
             FEDIT (S0QREPOR_3,
                    REQUIRED,
                    ALPHANB,
                    EQ,
                    ('  '),
                    WARNING,228)
             IF FAIL
               THEN S0QREPOR_3 = '';
           END;
     

 /* IF ( S0CFUNC_3 = '04' | S0CFUNC_3 = '99' ) &
      CGPART1T(3) = 'R'  &   
      USA
   THEN
     FEDIT (S0QREPOR_3,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,353)  */
     

 /* PROCESS PART LINE 4 */

 IF S0CFUNC_4 = '01'  |
    S0CFUNC_4 = '21' 
    THEN DO;
      FEDIT (S0QREPOR_4,
             REQUIRED,
             NUMB,
             PEND,242)

      IF S0CFUNC_4 = '01' & S0ISENOL > '496' & S0QREPOR_4 > '00'
        THEN DO;
          ERR_SW = ON;
          FEDIT (ERR_SW,
                 NOTALLOWED,
                 BI,
                 EQ,
                 (ON),
                 PEND,242)
          ERR_SW = OFF;
        END;
    END;
   ELSE
     IF S0CFUNC_4 = '99' 
       THEN FEDIT (S0QREPOR_4,
                   REQUIRED,
                   NUM,
                   GT,
                   ('00'),
                   PEND,242)
       ELSE
       IF S0CFUNC_4 = '03'  |
          S0CFUNC_4 = '04'
         THEN FEDIT (S0QREPOR_4,
                     REQUIRED,
                     NUM,
                     GT,
                     ('00'),
                     PEND,241)
         ELSE
         IF S0CFUNC_4 = '02'  |
            S0CFUNC_4 = '06' 
           THEN DO;
             FEDIT (S0QREPOR_4,
                    REQUIRED,
                    ALPHANB,
                    EQ,
                    ('  '),
                    WARNING,248)
             IF FAIL
               THEN S0QREPOR_4 = '';
           END;
     
 /* IF ( S0CFUNC_4 = '04' | S0CFUNC_4 = '99' ) &
      CGPART1T(4) = 'R'  &   
      USA
   THEN
     FEDIT (S0QREPOR_4,
            REQUIRED,
            NUM,
            EQ,
            ('01'),
            PEND,354)   */

 END REP_PART_QTY;

 %PAGE;
 REQUESTING_EMPLOYEE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  REQUESTING EMPLOYEE (329, 040)                                  */
 /*  ( IREQEMPL )                                                    */
 /*  ------------------------                                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*  IF THERE IS A VALUE IN REQUESTING EMPLOYEE, THERE CANNOT BE A   */
 /*  VALUE IN CONTRACT.                                              */
 /*  REQUESTING EMPLOYEE CANNOT BE EQUAL TO THE SSR SERIAL NUMBER    */
 /*  ENTERED THE QSAR.                                               */
 /*                                                                  */
 /********************************************************************/
   IF TEST_SW
     THEN DO;
       DIAG_TEXT = 'AERULE2: req empl '||IREQEMPL||
                   ' NERP? '||CFAILCD;
       CALL WRITE_TO_OPER;
     END;
   IF IREQEMPL ^= ''              /*INVALID EMP SERIAL IN CONTRACT   */
     THEN DO;
       FEDIT (CINVCNTR,
              REQUIRED,
              ALPHANB,
              EQ,
              (' '),
              PEND,329)
    /* IF FAIL &	      
        SUBSTR(CFAILCD,1,4) = 'NERP' &
        S0CSVC = '36'
       THEN DO;
         IREQEMPL = '';
         CALL RESET_PEND_MSGS(329);
       END;    */
     FEDIT (IREQEMPL,
            REQUIRED,
            ALPHANB,
            NE,
            (S0IEMPSE),
            PEND,040)
   END;          
                                  
 END  REQUESTING_EMPLOYEE;

 %PAGE;
 SERVICE_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  SERVICE CODE (003)                                              */
 /*  ( S0CSVC )                                                      */
 /*  ------------------------                                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_ONLY
   THEN FEDIT (S0CSVC,
               REQUIRED,
               NUM,
               EQ,
               ('01','08','20','33','36',
                '44','47','48','55','65','94'),
               PEND,003)

 IF S0CFUNC_1 = '02'  |
    S0CFUNC_1 = '21'  |
    S0CFUNC_2 = '02'  |
    S0CFUNC_2 = '21'  |
    S0CFUNC_3 = '02'  |
    S0CFUNC_3 = '21'  |
    S0CFUNC_4 = '02'  |
    S0CFUNC_4 = '21' 
   THEN FEDIT (S0CSVC,
               REQUIRED,
               NUM,
               PEND,003)
               
 END SERVICE_CODE;

 %PAGE;
 SERVICE_REQ:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  SERVICE REQUEST (030, 031)                                      */
 /*  ( S0CSREQ )   SCHEDULED Y/N                                     */
 /*  -----------------------------                                   */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER 
   THEN IF S0CSVC = '01'
     THEN DO;
       FEDIT (S0CSREQ,
              REQUIRED,
              NUMB,
              EQ,
              (' ','1','2'),
              WARNING,030)
       IF FAIL
         THEN S0CSREQ = '';
     END;
     ELSE DO;
       FEDIT (S0CSREQ,
              REQUIRED,
              ALPHANB,
              EQ,
              (' '),
              WARNING,031)
       IF FAIL
         THEN S0CSREQ = '';
     END;
     
 END SERVICE_REQ;

 %PAGE;
 SERVICE_TYPE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  SERVICE TYPE (032, 033)                                         */
 /*  ( S0CSTYPE )  CONCURRENT Y/N                                    */
 /*  ------------------------------                                  */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER
   THEN IF S0CSVC = '01' |
           S0CSVC = '33' 
          THEN DO;
            FEDIT (S0CSTYPE,
                   REQUIRED,
                   NUMB,
                   EQ,
                   (' ','1','2'),
                   WARNING,032)
            IF FAIL
              THEN S0CSTYPE = '';
          END;
          ELSE DO;
            FEDIT (S0CSTYPE,
                   REQUIRED,
                   ALPHANB,
                   EQ,
                   (' '),
                   WARNING,033)
            IF FAIL
              THEN S0CSTYPE = '';
          END;
          
 END SERVICE_TYPE;

 %PAGE;
 STOP_TIME:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  STOP TIME   (057)                                               */
 /*  ( S0QSTOTI )                                                    */
 /*  ------------------------                                        */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/
 SELECT;
   WHEN (PART_ONLY)
     DO;
    /*   IF IPETLVL >= 115                                           */
    /*     THEN                          /* STOP TIME NOT REQD FOR   */
    /*                                   /* DATA ENTERED VIA TRUER,  */
    /*                                   /* TRUER WILL CONTROL       */
    /*     ELSE FEDIT (S0QSTOTI,                                     */
    /*                 REQUIRED,                                     */
    /*                 NUMB,                                         */
    /*                 EQ,                                           */
    /*                 (' '),                                        */
    /*                 WARNING,057)                                  */
    /*                                                               */
    /*   IF FAIL THEN S0QSTOTI = ''                                  */
     END;

   WHEN (PART_TRAILER )
     DO;
     /*  IF IPETLVL >= 115           9/30/2003 LBS PROD SUPT         */
     /*    THEN                          /* STOP TIME NOT REQD FOR   */
     /*                                  /* DATA ENTERED VIA TRUER,  */
     /*                                  /* TRUER WILL CONTROL       */
     /*    ELSE FEDIT (S0QSTOTI,                                     */
       FEDIT (S0QSTOTI,
              REQUIRED,
              NUM,
              EQ,
              ('001'-'240'),
              PEND,057)
     END;

   WHEN (S0CSVC = '65' )
     DO;                                 /* STOP TIME NOT REQD FOR   */
                                         /* DATA ENTERED VIA PRISM,  */
                                         /* PRISM/QSAR WILL CONTROL  */
        IF S0QSTOTI ^= ''
          THEN FEDIT (S0QSTOTI,
                      REQUIRED,
                      NUM,
                      EQ,
                      ('001'-'240'),
                      WARNING,057)

       IF FAIL 
         THEN S0QSTOTI = '';
     END;

   OTHERWISE
     DO;
       FEDIT (S0QSTOTI,
              REQUIRED,
              NUM,
              EQ,
              ('001'-'240'),
              PEND,057)
     END;
   END;
   
 END STOP_TIME;

 %PAGE;
 TIN_NUMBER:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  TIN NUMBER (315, 316, 317, 318)                                 */
 /*  (ITINNBR (4) )                                                  */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

      IF CAPC(1) > '3'  /* | CAPC(1) = '1'  5NSM */
        THEN DO;
          FEDIT (TIN_REQ(1),
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 (' ','N'),
                 PEND,315)

          IF S0CFUNC_1 = '01'  |
             S0CFUNC_1 = '02'  |
             S0CFUNC_1 = '21' 
            THEN
              FEDIT (S0QDISUS_1,
                    REQUIRED,
                    NUM,
                    EQ,
                    ('01'),
                    PEND,160)
         
            ELSE
              IF S0CFUNC_1 = '99' 
                THEN
                  FEDIT (S0QREPOR_1,
                         REQUIRED,
                         NUM,
                         EQ,             
                         ('01'),         
                         PEND,162)       

                                   
                                     
        END;
        
      IF CAPC(2) > '3' /* | CAPC(2) = '1'   5NSM */
        THEN DO;
          FEDIT (TIN_REQ(2),
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 (' ','N'),
                 PEND,316)
          IF S0CFUNC_2 = '01'  |
             S0CFUNC_2 = '02'  |
             S0CFUNC_2 = '21' 
            THEN
              FEDIT (S0QDISUS_2,
                    REQUIRED,
                    NUM,
                    EQ,
                    ('01'),
                    PEND,190)
         
            ELSE
              IF S0CFUNC_2 = '99' 
                THEN
                  FEDIT (S0QREPOR_2,
                         REQUIRED,
                         NUM,
                         EQ,             
                         ('01'),         
                         PEND,192)       

        END;
        
      IF CAPC(3) > '3'   /*  | CAPC(3) = '1'  5NSM */
        THEN DO;
          FEDIT (TIN_REQ(3),
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 (' ','N'),
                 PEND,317)
          IF S0CFUNC_3 = '01'  |
             S0CFUNC_3 = '02'  |
             S0CFUNC_3 = '21' 
            THEN
              FEDIT (S0QDISUS_3,
                    REQUIRED,
                    NUM,
                    EQ,
                    ('01'),
                    PEND,220)
         
            ELSE
              IF S0CFUNC_3 = '99' 
                THEN
                  FEDIT (S0QREPOR_3,
                         REQUIRED,
                         NUM,
                         EQ,             
                         ('01'),         
                         PEND,222)       

        END;
        
      IF CAPC(4) > '3'  /* | CAPC(4) = '1'  5NSM  */
        THEN DO;
          FEDIT (TIN_REQ(4),
                 REQUIRED,
                 ALPHANB,
                 EQ,
                 (' ','N'),
                 PEND,318)
          IF S0CFUNC_4 = '01'  |
             S0CFUNC_4 = '02'  |
             S0CFUNC_4 = '21' 
            THEN
              FEDIT (S0QDISUS_4,
                    REQUIRED,
                    NUM,
                    EQ,
                    ('01'),
                    PEND,240)
         
            ELSE
              IF S0CFUNC_4 = '99' 
                THEN
                  FEDIT (S0QREPOR_4,
                         REQUIRED,
                         NUM,
                         EQ,             
                         ('01'),         
                         PEND,242)       

         END;
         
 END TIN_NUMBER;

 %PAGE;
 TRAVEL_HOURS:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  TRAVEL HOURS  (059)                                             */
 /*  ( S0QTRAHR )                                                    */
 /*  ------------                                                    */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

   IF ^PART_ONLY  &
      ^PART_TRAILER 
     THEN DO;
       FEDIT (S0QTRAHR,
              REQUIRED,
              NUMB,
              WARNING,059)
       IF FAIL
         THEN S0QTRAHR = '000';
     END;
  
   IF PART_TRAILER  |
      PART_ONLY 
     THEN S0QTRAHR = '000';
  
   IF S0QTRAMI > '000' 	
     THEN FEDIT (S0QTRAHR,
                 REQUIRED,
                 NUM,
                 GT,
                 ('000'),
                 WARNING,059)
  
   IF S0QTRAHR > '240' 
     THEN FEDIT (S0QTRAHR,
                 REQUIRED,
                 NUM,
                 LT,
                 ('241'),
                 WARNING,059)
  
 END TRAVEL_HOURS;

 %PAGE;
 USAGE_CRED:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  USAGE CREDIT  (090, 091)                                        */
 /*  ( S0QUSAGE )                                                    */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

 IF ^PART_TRAILER  &
    ^PART_ONLY 
   THEN DO;
     IF S0CSVC = '01'  |
        S0CSVC = '08'  |
        S0CSVC = '20'  |
        S0CSVC = '33'  |
        S0CSVC = '36'  |
        S0CSVC = '44'  |
        S0CSVC = '47'  |
        S0CSVC = '48' 
       THEN DO;
         FEDIT (S0QUSAGE,
                REQUIRED,
                NUMB,
                WARNING,090)
         IF FAIL
           THEN S0QUSAGE = '';
           
         IF CGFMETER ^= 'Y'
           THEN DO;
             FEDIT (S0QUSAGE,
                    REQUIRED,
                    ALPHANB,
                    EQ,
                    ('    '),
                    WARNING,091)
             IF FAIL
               THEN S0QUSAGE = '';
           END;
       END;
       ELSE DO;
         FEDIT (S0QUSAGE,
                REQUIRED,
                ALPHANB,
                EQ,
                ('    '),
                WARNING,091)
         IF FAIL
           THEN S0QUSAGE = '';
       END;
   END;

 END USAGE_CRED;

 %PAGE;
 ZIP_CODE:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  SERIVCE ZIP CODE (002)                                          */
 /*  ( S0CZIPCDE)                                                    */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*                                                                  */
 /********************************************************************/

  IF TEST_SW
    THEN DO;
     DIAG_TEXT = 'AERULE2: ZIPCODE ('||S0CZIPCDE||') VALID_ZIP_CODE('||
                                 VALID_ZIP_CODE||')';
     CALL WRITE_TO_OPER;
    END;

 IF S0CZIPCDE ^= '' 
   THEN DO;
     IF PART_ONLY
       THEN DO;
         FEDIT (VALID_ZIP_CODE,
                REQUIRED,
                ALPHAN,
                EQ,
                ('Y'),
                WARNING,002)                  /* ENTERED BUT INVALID */
         IF FAIL
           THEN S0CZIPCDE = '';
       END;
       ELSE
         FEDIT (VALID_ZIP_CODE,
                REQUIRED,
                ALPHAN,
                EQ,
                ('Y'),
                PEND,002)                     /* ENTERED BUT INVALID */

   END;

 END ZIP_CODE;

 %PAGE;
 WAYBILL:
 BEGIN REORDER;
 /********************************************************************/
 /*                                                                  */
 /*  WAYBILL (257)                                                   */
 /*  (IWAYBILL)                                                      */
 /*  --------------------------                                      */
 /*  SEE THE HELPAUDT DOCUMENT FOR A TRANSLATION OF THE AUDIT/EDIT   */
 /*  REQUIREMENTS FOR THIS FIELD                                     */
 /*  IF CONTRACT = 'ISSC92' PARTS ARE NOT PART OF THE CONDITION, BUT */
 /*  OTHER DELL CONTRACT ARE CHECKED WITH PART USAGE.  SEE TMF Z03.  */
 /*                                                                  */
 /********************************************************************/

  IF TEST_SW
    THEN DO;
     DIAG_TEXT = 'AERULE2: WAYBILL ('||IWAYBILL||')';
     CALL WRITE_TO_OPER;
    END;

 IF ( FOEMCNTR & IWAYBILL = ''  &
    (( S0CFUNC_1 = '02'   |
       S0CFUNC_1 = '04'   |
       S0CFUNC_1 = '21'   |
       S0CFUNC_1 = '99'   |
       S0CFUNC_2 = '02'   |
       S0CFUNC_2 = '04'   |
       S0CFUNC_2 = '21'   |
       S0CFUNC_2 = '99'   |
       S0CFUNC_3 = '02'   |
       S0CFUNC_3 = '04'   |
       S0CFUNC_3 = '21'   |
       S0CFUNC_3 = '99'   |
       S0CFUNC_4 = '02'   |
       S0CFUNC_4 = '04'   |
       S0CFUNC_4 = '21'   |
       S0CFUNC_4 = '99' )   | S0ICSS = 'ISSC92' )       )

   THEN DO;
     ERR_SW = ON;
     FEDIT (ERR_SW,
            NOTALLOWED,
            BI,
            EQ,
            (ON),
            WARNING,257)            /* WAYBILL MISSING             */
     ERR_SW = OFF;
   END;

 END WAYBILL;

  IF TEST_SW
    THEN DO;
     DIAG_TEXT = 'AERULE2: biosa ('||S0CBIOSA||')';
     CALL WRITE_TO_OPER;
    END;



 RETURN;
 END AUDIT_EDIT_RULE;
 /********************************************************************/
 /*  E N D   O F   A U D I T   E D I T   R U L E   # 2               */
 /********************************************************************/

